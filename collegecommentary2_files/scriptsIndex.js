"use strict";angular.module("schedulerAngularClientAppInternal",["schedulerAngularClientTranslations","schedulerAngularClientAppConstants","schedulerGroupAppInternal","schedulerClientCommon","wix","schedulerTemplatesInternal","schedulerAngularClientCommon","schedulerBiLogger","ngRoute"]),angular.module("schedulerTemplatesInternal",[]),angular.module("schedulerAngularClientAppConstants",[]),angular.module("schedulerGroupAppInternal",[]);try{angular.module("schedulerAngularClientTranslations")}catch(e){angular.module("schedulerAngularClientTranslations",["pascalprecht.translate"])}angular.module("schedulerAngularClientCommon",["wixSdkUtilInternal","schedulerCommonStatics"]),angular.module("wixSdkUtilInternal",["wix","schedulerAngularClientTranslations"]),angular.module("schedulerAngularClientBootstrap",["schedulerAngularClientAppInternal","ui.bootstrap"]).config(["$tooltipProvider",function(a){a.setTriggers({mouseenter:"mouseleave","staff-member-selection.open":"staff-member-selection.close","timezone-switch-popover.open":"timezone-switch-popover.close"})}]),angular.module("schedulerBiLogger",["wix.common.bi"]).config(["wixBiLoggerProvider","appEventMap",function(a,b){var c="";try{c=Wix.Utils.getInstanceValue("uid"),null===c&&(c=Wix.Utils.getInstanceValue("aid"))}catch(d){c=""}a.setConfig({eventMap:b,defaultEventArgs:{visitor_id:c,src:16,businessId:function(){try{return Wix.Utils.getInstanceId()}catch(a){return""}}(),is_over_editor:function(){try{return Wix.Utils.isOverEditor()}catch(a){return""}}(),is_owner:function(){try{return"OWNER"===Wix.Utils.getPermissions()}catch(a){return""}}(),biToken:function(){try{return Wix.Utils.getInstanceValue("biToken")}catch(a){return""}}()},adapter:"wixboost-ugc"})}]).run(["wixBiLogger",function(a){try{Wix.getCurrentPageId(function(b){a.log(a.events.SESSION_INFO,{pid:b})})}catch(b){}}]),angular.module("schedulerAngularClientApp",["schedulerAngularClientBootstrap","wixAngular","wixAngularStorage","isoCurrency","ui.calendar","ui.bootstrap","debounce","nr-ng-client","ngCookies","webPerfLogger"]).config(["$provide","webPerfLoggerAppNameProvider",function(a,b){b.setName("scheduler-client-desktop"),a.decorator("$exceptionHandler",["$delegate","$window",function(a,b){return function(c,d){b.trackJs&&"true"===bookingsExperiments["specs.TrackJSVisitorSpecs"]&&b.trackJs.track(c),a(c,d)}}])}]).config(["$routeProvider","clientPages",function(a,b){var c=b.PREFIX;a.when(c+b.VISITOR_SERVICES,{templateUrl:"modules/common/components/services-list/visitor-service-list.preload.html",reloadOnSearch:!1,controller:"ServicesCtrl as servicesCtrl",resolve:{serviceList:["servicesSrv",function(a){return a.gettingServices()}],groupList:["groupsSrv",function(a){return a.gettingGroupsList()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]}}).when(c+b.VISITOR_CALENDAR+"/:timezone?",{template:'<boost-calendar-page business-timezone="{{$resolve.businessTimezone}}" user-timezone="{{$resolve.userTimezone}}"/>',reloadOnSearch:!0,resolve:{capableStaff:["visitorStaffSrv",function(a){return a.getCapableStaff()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],userTimezone:["timezoneSrv",function(a){return a.gettingUserTimezone()}],businessTimezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return a.timeZone})}],selectedServiceEnforced:["ServiceTypes","appointmentService",function(a,b){b.enforceSelectedServiceType(a.INDIVIDUAL)}],firstAvailableDate:["timezoneSrv","appointmentService","slotsSrv",function(a,b,c){return a.gettingUserTimezone().then(function(a){var d=b.getSelectedService();return c.getFirstAvailableSlotForIndividualService(d,a)})}]}}).when(c+b.VISITOR_CONTACT_INFO,{template:"<boost-visitor-contact-info-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],timezone:["appointmentService",function(a){return a.getSelectedTime().timeZone}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]},reloadOnSearch:!1}).when(c+b.VISITOR_GROUPS_CONTACT_INFO,{template:"<boost-groups-visitor-contact-info-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]},reloadOnSearch:!1}).when(c+b.VISITOR_CONFIRMATION,{templateUrl:"modules/visitor/visitor-confirmation.preload.html",reloadOnSearch:!1,controller:"VisitorConfirmationController as confirmationCtrl",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}]}}).when(c+b.VISITOR_CONGRATS,{template:"<boost-individual-congratulations-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(c+b.GROUPS_VISITOR_CONGRATS,{template:"<boost-group-congratulations-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(c+b.VISITOR_GROUPS_CALENDAR,{template:"<boost-groups-calendar></boost-groups-calendar>",reloadOnSearch:!1,resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],selectedServiceEnforced:["ServiceTypes","appointmentService",function(a,b){b.enforceSelectedServiceType(a.GROUP)}],firstAvailableDate:["appointmentService","groupsSrv",function(a,b){var c=a.getSelectedService();return b.getFirstAvailableSlotForPrototype(c)}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(c+b.VISITOR_GROUPS,{template:"<boost-group-list-page>",resolve:{groupList:["groupsSrv",function(a){return a.gettingGroupsList()}],serviceList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]}}).when(c+b.VISITOR_SPLASH,{template:"<boost-service-type-page></boost-service-type-page>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]}}).when(c+b.WIDGET_INDIVIDUAL+"/:serviceId",{template:"<boost-widget-route></boost-widget-route>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]},serviceType:"individual"}).when(c+b.WIDGET_GROUP+"/:serviceId",{template:"<boost-widget-route></boost-widget-route>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]},serviceType:"group"}).when(c+b.USER_ACCOUNT_MANAGEMENT,{redirectTo:function(){return c+b.USER_ACCOUNT_MANAGEMENT+"/"+b.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS}}).when(c+b.USER_ACCOUNT_MANAGEMENT+"/"+b.USER_ACCOUNT_MANAGEMENT_INFO,{template:"<bks-account-management-user-info/>"}).when(c+b.USER_ACCOUNT_MANAGEMENT+"/"+b.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,{template:'<bks-account-management-bookings booking-list="$resolve.bookingList" timezone="{{$resolve.timezone}} "/>',resolve:{timezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return a.timeZone})}],bookingList:["bookingHistorySrv",function(a){return a.gettingBookings()}]}}).otherwise({redirectTo:function(){return c+b.VISITOR_SPLASH}})}]).run(["newRelicSrv",function(a){a.setSubAppName("visitorDesktop")}]),angular.module("schedulerAngularClientApp").config(["routeManagerProvider","clientPages",function(a,b){a.setPrefix(b.PREFIX)}]).run(["visitorBiListener",function(a){a.init()}]).run(["$route","$rootScope","eventsConst","$location","$routeParams","$window","wixSdkUtil","clientPages","routeManager","wixPageNavigation","userManagementSrv",function(a,b,c,d,e,f,g,h,i,j,k){i.suspendFocus=!0,b.$on("$locationChangeStart",function(a,b){k.isPathAllowed(b)||i.gotoPage("")}),b.$on("$routeChangeStart",function(){b.$emit("showLoading")}),j.init(),b.$on("$routeChangeSuccess",function(a,h,j){b.$emit("hideLoading"),b.$emit(c.CONTENT_CHANGED);var k=d.path()+"?";angular.forEach(e,function(a,b){k+=b+"="+a+"&"}),k=k.substr(0,k.length-1),f._gaq&&f._gaq.push(["_trackPageview",k]),j&&(i.suspendFocus===!1&&g.resetHeight(),i.suspendFocus=!1)}),a.reload()}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.staffMember=c,this.time=moment.tz(+a,b)}return a.prototype.getStaff=function(){return this.staffMember},a.prototype.getTime=function(){return this.time},a.prototype.getTimeStamp=function(){return+this.time.format("x")},a}();a.TimeSlotOption=b}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.TILE_IMAGE_SHAPE=a,this.commonServices=b}return a.prototype.isSquareImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.SQUARE},a.prototype.isRoundImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.ROUND},a.prototype.isImageVisible=function(){return this.tileConfig.imageType!==this.TILE_IMAGE_SHAPE.NONE},a.prototype.getImageUrl=function(a,b){return this.commonServices.getImageUrl(a,b)},a}();a.BaseTileController=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){function a(a){a.$emit("we are using controllerAs syntax, scope is used only for events and watches"),this.awesomeThings=["Bower","Grunt","Haml","Compass","AngularJS","Karma"]}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").controller("MainController",a)}(),function(){function a(a,b,c,d){this.next=function(){b.gotoPage(c.VISITOR_CALENDAR)},this.doAddAppointment=function(){var b={timestamp:d.$("#asdate").val(),email:d.$("#aemail").val()};a.addingAppointment("api/visitor/appointments","PUT",b)}}a.$inject=["appointmentService","routeManager","clientPages","libs"],angular.module("schedulerAngularClientAppInternal").controller("AddAppointmentController",a)}();var BaseServicesCtrl=function(){function a(a,b,c,d,e){this.groupsSrv=a,this.servicesSrv=b,this.SERVICE_CATEGORY_LAYOUT=c,this.commonServices=d,this.firstServiceType=e.getServiceTypeOrder()}return a.$inject=["groupsSrv","servicesSrv","SERVICE_CATEGORY_LAYOUT","commonServices","appSettings"],a.prototype.hasGroupsServices=function(){return this.groupsSrv.hasRealGroups(this.groupsList)},a.prototype.hasIndividualServices=function(){return this.servicesSrv.hasRealServices(this.serviceList)},a.prototype.isCategoriesAvailable=function(){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE},a.prototype.updatePerCategory=function(a,b){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE?this.commonServices.getServicesForCategory(a):b},a}();!function(){function a(a,b,c,d,e,f,g,h,i,j,k){function l(a,b,c){var d;return d=q.isGroupService(b)?c&&c.groupInstance?c.groupInstance[a]:"":b[a]}function m(a){var b={email:a.email,fullName:a.name,phoneNumber:a.phone,message:a.message};return a.address&&(b.addressLine=a.address.addressLine,b.apartmentNum=a.address.aptOrFloor,b.city=a.address.city),b}function n(){var a=q.getContactInfo(),b=q.getSelectedTime(),c=q.getSelectedService(),d=m(a);return d.serviceId=c.id,d.payment=q.getPaymentInfo(),d.timestamp=parseInt(b.startTime,10),d.timeZone=b.timeZone,g.isMultipleCalendarsEnabled()&&(d.staffMemberId=b.staffMember.id),d}function o(){var a={},b=q.getContactInfo(),c=q.getSelectedTime(),d=q.getSelectedService(),e=m(b);return a.classInstanceId=c.groupInstance.id,a.payment=q.getPaymentInfo(),a.participants=[e],a.numberOfParticipants=d.numberOfParticipants,a}function p(a){var c=q.getSelectedService();return c.type===e.GROUP?b.registeringToGroup(o(),a):b.creatingAppointment(n(),a)}var q=this;this.init=function(){q.fillContactInfoWithLoggedInUserDetails(),k.$on(wix.bookings.user.UserManagementSrv.LOGOUT_INITIATED,function(){a.clearKey("contactInfo")})},this.initiate=function(b){return q.serviceWithZeroPricePaymentTypeOnlineWorkaround(b),a.clearKey("bookingInfo"),a.clearKey("appointmentDateTime"),this.persist(b)},this.persist=function(b){return a.setToCache("selectedService",b)},this.enforceSelectedServiceType=function(b){var c=a.getFromCache("selectedService");c&&b!==c.type&&a.clearKey("selectedService")},this.getSelectedService=function(){var b=a.getFromCache("selectedService");return b=c.enrichServiceIfOverEditor(b)},this.getPaymentType=function(){return a.getFromCache("selectedPaymentType")},this.setPaymentType=function(b){return a.setToCache("selectedPaymentType",b)},this.serviceWithZeroPricePaymentTypeOnlineWorkaround=function(a){0===a.price&&a.paymentType===h.PAYMENT_TYPE_ONLINE&&(a.paymentType=h.PAYMENT_TYPE_OFFLINE,a.isFree=!0)},this.fillContactInfoWithLoggedInUserDetails=function(){var a=j.getCurrentSiteMember();!c.isOverEditor&&a.email&&this.setContactInfo({email:a.email,name:a.fullName,phone:a.phoneNumber})},this.setPaymentInfo=function(b){return a.setToCache("paymentInfo",b)},this.getPaymentInfo=function(){return a.getFromCache("paymentInfo")},this.setCurrentBooking=function(b){return a.setToCache("bookingInfo",b)},this.getCurrentBooking=function(){return a.getFromCache("bookingInfo")},this.getSelectedTime=function(){return c.enrichSelectedTimeIfOverEditor(a.getFromCache("appointmentDateTime"))},this.setSelectedTime=function(b){return a.setToCache("appointmentDateTime",b)},this.getContactInfo=function(){return c.enrichContactIfOverEditor(a.getFromCache("contactInfo"))},this.setContactInfo=function(b){return a.setToCache("contactInfo",b)},this.save=function(){var a=d.defer();return c.isDemoFlow?(f.appointmentCreated(),d.when({})):(p(q.isConflictingAppointment).then(function(b){f.appointmentCreated(),a.resolve(b)})["catch"](function(b){a.reject(b)}),a.promise)},this.isConflictingAppointment=function(a){return a&&409===a.status&&a.data&&-7===a.data.errorCode},this.getAppointmentLocation=function(a,b){return a=this.populateService(a),b=this.populateTime(b),l("location",a,b)},this.getAppointmentLocationText=function(a,b){return a=this.populateService(a),b=this.populateTime(b),l("locationText",a,b)},this.isGroupService=function(a){return a.type===e.GROUP},this.isShowBusinessAddress=function(a,b,c,d){return a=this.populateService(a),b=this.populateTime(b),d=d||!1,q.isShowBusinessAddressIndividual(a,b,c,d)||q.isShowBusinessAddressGroups(a,b)},this.populateService=function(a){return a||(a=q.getSelectedService()),a},this.populateTime=function(a){return a||(a=q.getSelectedTime()),a},this.isShowBusinessAddressIndividual=function(a,b,c,d){var e=q.getAppointmentLocation(a,b);return!q.isGroupService(a)&&(q.isCustomerLocationToShow(e,d)||q.isBusinessLocationOnTheGoAndNotServiceLocationCustomer(e,c))},this.isCustomerLocationToShow=function(a,b){return"CUSTOMER"===a&&b},this.isBusinessLocationOnTheGoAndNotServiceLocationCustomer=function(a,b){return"CUSTOMER"!==a&&(!b||"ON_THE_GO"!==b.businessLocation)},this.isShowBusinessAddressGroups=function(a,b){return q.isGroupService(a)&&!!b&&!!b.groupInstance},this.getBusinessCity=function(a,b,c){if(b=this.populateService(b),c=this.populateTime(c),!this.isOtherLocation(b,c)&&"ON_THE_GO"!==a.businessLocation){var d=a.city,e=a.zipCode;return i("sidebar.address.line2",{city:d,zipCode:e})}},this.isOtherLocation=function(a,b){return"OTHER"===this.getAppointmentLocation(a,b)},q.init()}a.$inject=["cacheSrv","visitorApi","overEditor","$q","ServiceTypes","visitorBILogger","experimentsEnabler","paymentType","$translate","userManagementSrv","$rootScope"],angular.module("schedulerAngularClientAppInternal").service("appointmentService",a)}(),function(){angular.module("schedulerAngularClientAppConstants").constant("serviceConst",{LOCATION_CUSTOMER:"CUSTOMER",LOCATION_OTHER:"OTHER",LOCATION_BUSINESS:"BUSINESS",LOCATIONS_WITH_ADDRESS:["CUSTOMER"]}).constant("SERVICE_EDITOR_DEFAULTS",{imagesList:[{images:[{fileName:"Receptionist",relativeUri:"413707c67361480983896a2e55509f29.jpg",width:7360,height:4912}]},{images:[{fileName:"Clock",relativeUri:"2c2ed29dab6946dfb37072e57fd294a3.jpg",width:3666,height:2435}]},{images:[{fileName:"Modern Coffee Table",relativeUri:"6142ea7f91914d1c9bee8f8380110f78.jpg",width:3025,height:1706}]},{images:[{fileName:"Laptop",relativeUri:"f656fb99b72847c7b66e01324d843074.jpg",width:2560,height:1709}]},{images:[{fileName:"Business Meeting ",relativeUri:"bfc7011abc1642358204a81111b9e72b.jpg",width:4368,height:2912}]},{images:[{fileName:"Table Plant",relativeUri:"e2d524c78f3842a1b74dc3b2f4827727.jpg",width:2560,height:1709}]},{images:[{fileName:"Cactus Plant ",relativeUri:"a781e4805ee549c193112e17192b376c.jpg",width:2560,height:1707}]},{images:[{fileName:"Making Appointments",relativeUri:"7f70fae2af3e444d9ab8c3b7698a6c1a.jpg",width:4944,height:3948}]},{images:[{fileName:"Coffee Time",relativeUri:"d18f6586a05443c8a8d4b671cee5ea4c.jpg",width:2560,height:1707}]}]}).constant("SERVICE_IMAGE_SIZE",{angelina:{width:105,height:105},angelina_round:{width:105,height:105},heidi:{width:470,height:446},heidi_round:{width:360,height:360},bar:{width:300,height:200},bar_round:{width:185,height:185},bar_with_sidebar:{width:370,height:220},bar_with_sidebar_round:{width:225,height:225},mobile:{width:282,height:169},mobile_round:{width:370,height:169}}).constant("ServiceTypes",{GROUP:"GROUP",INDIVIDUAL:"INDIVIDUAL"}).constant("GROUP_IMAGE_SIZE",{simple:{width:470,height:446}})}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.imagesList=[],this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"94529b508b40459fb23e9c35b7e7cc0c.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"2789fba4f9de4318a4fe0cbcfd39b671.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"515c2410e09149e89d8d70b84beaba0a.jpg",width:2560,height:1707}]})}return a}();a.GroupEditorDefaults=b,angular.module("schedulerAngularClientAppConstants").constant("GROUP_EDITOR_DEFAULTS",new b)}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.BUSINESS=0]="BUSINESS",a[a.USER=1]="USER"}(b=a.Timezones||(a.Timezones={}))}(b=a.constants||(a.constants={}))}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.Timezones,d=function(){function a(a,b,c,d,e,f){this.momentSrv=a,this.libs=b,this.visitorBILogger=c,this.cacheSrv=d,this.experimentsEnabler=e,this.$translate=f,"true"===this.openByDefault&&this.openPopover()}return a.$inject=["momentSrv","libs","visitorBILogger","cacheSrv","experimentsEnabler","$translate"],a.prototype.isPopoverOpen=function(){return this.popoverOpen},a.prototype.togglePopover=function(){this.popoverOpen?this.closePopover():this.openPopover()},a.prototype.openPopover=function(){this.popoverOpen=!0,this.visitorBILogger.logPopupOpened(),this.cacheSrv.setToCache(a.CACHE_KEY,!0)},a.prototype.closePopover=function(){this.popoverOpen=!1,this.visitorBILogger.logPopupClosed("time_zone")},a.prototype.onSwitch=function(a){this.onSwitchCallback({timezone:a})},a.prototype.isBusiness=function(){return+this.currentTimezone===c.BUSINESS},a.prototype.isUser=function(){return+this.currentTimezone===c.USER},a.prototype.calculateOffset=function(a){return this.momentSrv.timestampToLocaleMoment(this.nowTimestamp(),a).format("Z")},a.prototype.nowTimestamp=function(){return this.libs.moment().format("x")},a.prototype.timezoneString=function(a){return+a===c.BUSINESS?this.businessTimezone:this.userTimezone},a.prototype.currentTimezoneOffset=function(){return this.calculateOffset(this.timezoneString(this.currentTimezone))},a.prototype.userTimezoneOffset=function(){return this.calculateOffset(this.userTimezone)},a.prototype.businessTimezoneOffset=function(){return this.calculateOffset(this.businessTimezone)},a.prototype.getBookingBaseOnTimeZoneText=function(){var a="";return a=this.isBusiness()?this.experimentsEnabler.isCityTimezoneEnabled()?this.$translate("calendar.timezone-city-switch.business",{city:this.getTranslateTimezoneCity(this.timezoneString(this.currentTimezone)),offset:this.currentTimezoneOffset()}):this.$translate("calendar.timezone-switch.business",{offset:this.currentTimezoneOffset()}):this.$translate("calendar.timezone-switch.user")},a.prototype.getTranslateTimezoneCity=function(a){return this.$translate("timezone-"+a+"-city")},a}();d.CACHE_KEY="tz_switch_shown",b.TimezoneSwitch=d,angular.module("schedulerAngularClientAppInternal").component("bksTimezoneSwitch",{template:'\n               <div class="timezone-switch" ng-click="$ctrl.togglePopover()" data-hook="timezone-switch">\n                 <div class="timezone-switch__icon scheduler-svg-font-icons-clock-icon"\n                 bks-timezone-switch-popover="test"\n                 bks-timezone-switch-popover-placement="bottom"\n                 bks-timezone-switch-popover-animation="false"\n                 bks-timezone-switch-popover-is-open="$ctrl.isPopoverOpen()"\n                 bks-timezone-switch-popover-on-close="$ctrl.closePopover()"\n                 bks-timezone-switch-popover-on-switch="$ctrl.onSwitch(timezone)"\n                 bks-timezone-switch-popover-append-to-body="true"\n                 bks-timezone-switch-popover-btz="{{$ctrl.businessTimezone}}"\n                 bks-timezone-switch-popover-utz="{{$ctrl.userTimezone}}"\n                 bks-timezone-switch-popover-current="{{$ctrl.currentTimezone}}"\n                 bks-timezone-switch-popover-utz-offset="{{$ctrl.userTimezoneOffset()}}"\n                 bks-timezone-switch-popover-btz-offset="{{$ctrl.businessTimezoneOffset()}}"\n               ></div>\n                 <div class="timezone-switch__label" data-hook="timezone-switch-label">\n                    {{$ctrl.getBookingBaseOnTimeZoneText()}}\n                 </div>\n               </div>',controller:d,bindings:{businessTimezone:"@",userTimezone:"@",onSwitchCallback:"&onSwitch",currentTimezone:"@",openByDefault:"@"}})}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(a,b,c){var d=a.$parent.$parent.$parent,f=d.onSwitch,g=d.onClose,h=d.userOffset,i=d.businessOffset,j=d.userTimezone,k=d.businessTimezone,l=function(){return+d.currentTimezone};a.userOffset=h,a.businessOffset=i,a.onSwitch=function(){var b=a.isBusinessTimezone()?e.USER:e.BUSINESS;f(b),g()},a.isBusinessTimezone=function(){return l()===e.BUSINESS},a.isUserTimezone=function(){return l()===e.USER},a.close=function(){return g()},a.getSwitchText=function(){if(c.isCityTimezoneEnabled()){if(a.isUserTimezone()){var d=a.getTranslateTimezoneCity(k);return b("calendar.timezone-switch.popover.user-city.button",{offset:i,city:d})}var d=a.getTranslateTimezoneCity(j);return b("calendar.timezone-switch.popover.business-city.button",{city:d})}return a.isUserTimezone()?b("calendar.timezone-switch.popover.user.button",{offset:i}):b("calendar.timezone-switch.popover.business.button")},a.getCurrentStateText=function(){if(c.isCityTimezoneEnabled()){if(a.isUserTimezone()){var e=a.getTranslateTimezoneCity(d.userTimezone);return b("calendar.timezone-switch.popover.user-city.message",{city:e})}var e=a.getTranslateTimezoneCity(d.businessTimezone);return b("calendar.timezone-switch.popover.business-city.message",{offset:i,city:e})}return a.isUserTimezone()?b("calendar.timezone-switch.popover.user.message"):b("calendar.timezone-switch.popover.business.message",{offset:i})},a.getTranslateTimezoneCity=function(a){return b("timezone-"+a+"-city")}}function d(a){return{restrict:"EA",replace:!0,controller:c,bindToController:!0,controllerAs:"$ctrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:function(){return a.getIsMobile()?'<div class="timezone-switch-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="timezone-switch-popover">\n                <div class="arrow"></div>\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state">{{ ::getCurrentStateText()}}</div>\n                        <a class="timezone-switch-popover__switch-button" data-hook="tsp-switch-to" ng-click="onSwitch()">{{ ::getSwitchText()}}</a>\n                    </div>\n                </div>\n             </div>':'\n             <div class="timezone-switch-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="timezone-switch-popover">\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div ng-click="close()" class="timezone-switch-popover__close scheduler-svg-font-icons-close" data-hook="tsp-close"></div>\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state">{{::getCurrentStateText()}}</div>\n                        <button class="btn-primary" type="button" data-hook="tsp-switch-to" ng-click="onSwitch()">{{::getSwitchText()}}</button>\n                    </div>\n                </div>\n             </div>'}}}c.$inject=["$scope","$translate","experimentsEnabler"];var e=a.boost.common.constants.Timezones;b.TimezoneSwitchPopoverCtrl=c,angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopoverPopup",["appConfig",d]),angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopover",["$tooltip","$timeout","momentSrv","libs",function(a,b){var c=a("bksTimezoneSwitchPopover","bksTimezoneSwitchPopover","timezone-switch-popover.open");c.scope={isOpen:"=bksTimezoneSwitchPopoverIsOpen",onCloseCallback:"&bksTimezoneSwitchPopoverOnClose",onSwitchCallback:"&bksTimezoneSwitchPopoverOnSwitch",businessTimezone:"@bksTimezoneSwitchPopoverBtz",userTimezone:"@bksTimezoneSwitchPopoverUtz",currentTimezone:"@bksTimezoneSwitchPopoverCurrent",userOffset:"@bksTimezoneSwitchPopoverUtzOffset",businessOffset:"@bksTimezoneSwitchPopoverBtzOffset"};var d=c.compile();return{restrict:"A",scope:c.scope,link:function(a,c,e){d.call(null,a,c,e);var f=function(a){return b(function(){return c.trigger(a)})},g=function(){return f("timezone-switch-popover.close")};a.onClose=function(){g(),a.onCloseCallback()},a.$watch("isOpen",function(a){a?f("timezone-switch-popover.open"):g()}),a.onSwitch=function(b){a.onSwitchCallback({timezone:b})}}}}])}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.calendar.TimeSlotOption,d=a.boost.common.constants.Timezones,e=a.bookings.visitor.components.TimezoneSwitch,f=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(this.$scope=a,this.$rootScope=b,this.slotsSrv=c,this.appointmentService=d,this.$route=e,this.clientPages=f,this.routeManager=g,this.flowManagerSrv=h,this.$timeout=i,this.wixBiLogger=j,this.$wix=k,this.TimeOfDay=l,this.CALENDAR_EVENTS=m,this.visitorBILogger=n,this.experimentsEnabler=o,this.$routeParams=p,this.$q=q,this.cacheSrv=r,this.isActionComplete=!1,this.IS_MULTI_EXPERIMENT_ON=o.isMultipleCalendarsEnabled(),this.selectedService=this.appointmentService.getSelectedService(),this.staff=e.current.locals.staff,this.firstAvailableDate=e.current.locals.firstAvailableDate,this.currentTimezone=this.determineInitialTimezone(p.timezone),this.visitorBILogger.logTimezone(),this.IS_MULTI_EXPERIMENT_ON){var t=e.current.locals.capableStaff;this.capableStaff=s(OrderByLowerCase.FILTER_NAME)(t.map(function(a){return{value:a.id,label:a.fullName}}),"label")}this.registerListeners(a,m,n),this.restorePreviousStateIfPresent()}return a.$inject=["$scope","$rootScope","slotsSrv","appointmentService","$route","clientPages","routeManager","flowManagerSrv","$timeout","wixBiLogger","$wix","TimeOfDay","CALENDAR_EVENTS","visitorBILogger","experimentsEnabler","$routeParams","$q","cacheSrv","$filter"],a.prototype.determineInitialTimezone=function(a){var b=this.appointmentService.getSelectedTime();return angular.isDefined(a)?+a:b?b.timeZone===this.businessTimezone?d.BUSINESS:d.USER:this.experimentsEnabler.isClientTimeZoneEnabled()?d.BUSINESS:d.USER},a.prototype.registerListeners=function(a,b,c){var d=this;a.$on(b.DAY_SELECTED,function(a,b){d.slot=null,d.isActionComplete=!1,d.selectedDate=b.startOf("day"),d.availableSlotsForDay=d.createAvailableSlotsForDay(d.selectedDate),d.storeLastSelectionIfOverTheEditor(b.format("x")),d.handlePrepopulatedDateIfRequired()}),a.$on(b.SLOT_SELECTED,function(a,b){c.selectSlot(),d.IS_MULTI_EXPERIMENT_ON?d.isActionComplete=!!b.getStaff():d.isActionComplete=!0,d.slot=b})},a.prototype.getCapableStaff=function(){return this.capableStaff},Object.defineProperty(a.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),a.prototype.handlePrepopulatedDateIfRequired=function(){var a=this;if(this.prePopulatedDate){var b=this.prePopulatedDate,d=b.startTime,e=b.staffMember,f=new c(+d,this.currentTimezoneString(),e);this.$timeout(function(){a.$rootScope.$broadcast(a.CALENDAR_EVENTS.SLOT_SELECTED,f),a.prePopulatedDate=null})}},a.prototype.storeLastSelectionIfOverTheEditor=function(a){this.$wix.isInEditingMode()&&this.appointmentService.setSelectedTime({startTime:a})},a.prototype.restorePreviousStateIfPresent=function(){var a,b=this,c=this.appointmentService.getSelectedTime();if(c)this.prePopulatedDate=c,a=c.startTime;else{var d=this.appointmentService.getCurrentBooking();d&&(a=d.start)}a&&this.$timeout(function(){b.$rootScope.$broadcast(b.CALENDAR_EVENTS.SELECT_DATE,moment.tz(+a,b.currentTimezoneString()))},200)},a.prototype.createAvailableSlotsForDay=function(a){return this.slotsSrv.partitionSlotsIntoPartsOfDay(this.staffMemberAvailabilityInRange,a,this.currentTimezoneString())},a.prototype.getSlotsAvailability=function(a){var b=this;return this.staffMemberUpdated?(this.staffMemberUpdated=!1,this.$q.when(this.staffMemberAvailabilityInRange)):this.slotsSrv.getSlotsAvailability(a,this.currentTimezoneString(),this.selectedService).then(function(a){return b.slotsAvailabilityForRange=a,b.resolveStaffMemberAvailability(),a})},a.prototype.getAvailableSlotsDuringTimeOfDay=function(a){return this.availableSlotsForDay[a]},a.prototype.getMorningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.MORNING)},a.prototype.getAfternoonSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.AFTERNOON)},a.prototype.getEveningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.EVENING)},a.prototype.isDaySelected=function(){return!!this.selectedDate},a.prototype.getSlotRange=function(){var a=this.slot.getTime();return{start:a,end:a.clone().add(this.selectedService.duration,"minutes")}},a.prototype.goToNextPage=function(){this.storeSlotData(),this.wixBiLogger.log(this.wixBiLogger.events.NEXT,{referal_info:"date&time"}),this.flowManagerSrv.next()},a.prototype.storeSlotData=function(){var a=this.getSlotDataToStore();this.appointmentService.setSelectedTime(a)},a.prototype.getSlotDataToStore=function(){var a=this.getSlotRange(),b={startTime:a.start.format("x"),endTime:a.end.format("x"),timeZone:this.currentTimezoneString(),staffMember:this.slot.getStaff()};return b},a.prototype.currentTimezoneString=function(){
return this.currentTimezone===d.BUSINESS?this.businessTimezone:this.userTimezone},a.prototype.goBack=function(){this.flowManagerSrv.prev()},a.prototype.isDayFull=function(){return!this.slotsSrv.getAvailableSlotsForTheDay(this.slotsAvailabilityForRange,this.selectedDate,this.currentTimezoneString())},a.prototype.onCalendarRendered=function(){this.firstAvailableDate&&(this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GO_TO_MONTH,this.firstAvailableDate),this.firstAvailableDate=null)},a.prototype.onStaffSelected=function(a){this.currentStaffMemberId!==a&&(this.currentStaffMemberId=a,this.resolveStaffMemberAvailability(),this.staffMemberUpdated=!0,this.deselectDay(),this.expandCalendar(),this.forceAvailableDatesRefresh(),this.visitorBILogger.staffMemberSelectionChangedFromCalendar())},a.prototype.promptTimezoneSwitch=function(){return!angular.isDefined(this.$routeParams.timezone)&&!this.prePopulatedDate&&!this.cacheSrv.getFromCache(e.CACHE_KEY)},a.prototype.expandCalendar=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.EXPAND)},a.prototype.deselectDay=function(){this.selectedDate=null},a.prototype.forceAvailableDatesRefresh=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,this.currentTimezoneString())},a.prototype.onTimezoneSwitch=function(a){this.visitorBILogger.timezoneSwitched(a),this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR+"/"+a)},a.prototype.resolveStaffMemberAvailability=function(){this.currentStaffMemberId?this.staffMemberAvailabilityInRange=this.slotsSrv.getAvailabilityOfStaffMember(this.slotsAvailabilityForRange,this.currentStaffMemberId):this.staffMemberAvailabilityInRange=this.slotsAvailabilityForRange},a.prototype.allowTimezoneSwitch=function(){return this.experimentsEnabler.isClientTimeZoneEnabled()&&this.userTimezone!==this.businessTimezone},a}();b.CalendarPageCtrl=f,angular.module("schedulerAngularClientAppInternal").controller("CalendarPageCtrl",f).directive("boostCalendarPage",function(){return{templateUrl:"modules/calendar-page/calendar-page.preload.html",controller:f,controllerAs:"clpCtrl",bindToController:!0,restrict:"EA",scope:{businessTimezone:"@",userTimezone:"@"}}})}(c=b.calendar||(b.calendar={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.NEXT="DispatchedEvents.NEXT",b.APPOINTMENT_BOOKED="DispatchedEvents.APPOINTMENT_BOOKED",b.PAYMENT_METHOD_MODAL_OPENED="DispatchedEvents.PAYMENT_METHOD_MODAL_OPENED",b.CONTACT_INFO_SAVE_SUCCESS="DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS",b.CANCELLATION_POLICY="DispatchedEvents.CANCELLATION_POLICY",b.CHOOSE_TIME_SLOT="DispatchedEvents.CHOOSE_TIME_SLOT",b.BOOK_ANOTHER="DispatchedEvents.BOOK_ANOTHER",b.GOOGLE_EXPORT="DispatchedEvents.GOOGLE_EXPORT",b.BOOKIT="DispatchedEvents.BOOKIT",b.BOOKED_GROUP_BUT_NOT_PREMUIM="DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM",b.CAL_TODAY="DispatchedEvents.CAL_TODAY",b.SERVICE_TYPE_WELCOME_PAGE="DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE",b.SWITCH_SERVICE_TYPE="DispatchedEvents.SWITCH_SERVICE_TYPE",b.CAL_MOVE="DispatchedEvents.CAL_MOVE",b.PAYPAL_REDIRECT_DONE="DispatchedEvents.PAYPAL_REDIRECT_DONE",b.PAYMENT_METHOD_SELECTED_MODAL="DispatchedEvents.PAYMENT_METHOD_SELECTED_MODAL",b.SERVICES_PAGE_OPENED="DispatchedEvents.SERVICES_PAGE_OPENED",b.CHOOSE_STAFF_MEMBER_POPUP_OPENED="DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED",b.CHOOSE_STAFF_MEMBER="DispatchedEvents.CHOOSE_STAFF_MEMBER",b.CHANGE_STAFF_MEMBER_SELECTION="DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION",b.PAYPAL_WINDOW_OPENED="DispatchedEvents.PAYPAL_WINDOW_OPENED",b.LOG_TIMEZONE="DispatchedEvents.LOG_TIMEZONE",b.PARTICIPANTS_AMOUNT_CHANGE="DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE",b.POPUP_CLOSED="DispatchedEvents.CLOSE_POPUP",b.TIMEZONE_POPUP_OPENED="DispatchedEvents.TIMEZONE_POPUP_OPENED",b.TIMEZONE_SWITCH="DispatchedEvents.TIMEZONE_SWITCH",b.DEEP_LINK_CALENDAR_OPEN="DispatchedEvents.DEEP_LINK_CALENDAR_OPEN",b.LOGIN_CLICKED="DispatchedEvents.LOGIN_CLICKED",b.LOGIN_COMPLETE="DispatchedEvents.LOGIN_COMPLETE",b.GO_TO_ACCOUNT_MANAGEMENT="DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT",a.DispatchedEvents=b;var c=function(){function a(){this.BOOKIT={evid:501},this.MORE={evid:502},this.CAL_OPEN={evid:503},this.CAL_MOVE={evid:504},this.CAL_TODAY={evid:505},this.CHOOSE_TIME_SLOT={evid:506},this.CHANGE={evid:508},this.NEXT={evid:509},this.BACK={evid:510},this.SYS_MSG_CLOSE={evid:511},this.BOOK_ANOTHER={evid:512},this.GOOGLE_EXPORT={evid:513},this.PICK_DATES_MOBILE={evid:516},this.SERVICES_PAGE_OPENED={evid:515},this.SESSION_INFO={evid:514},this.CONTACT_INFO_SAVE_SUCCESS={evid:517},this.PAYMENT_METHOD_SELECTED_MODAL={evid:518},this.PAYPAL_REDIRECT_DONE={evid:519},this.CANCELLATION_POLICY={evid:521},this.SERVICE_TYPE_WELCOME_PAGE={evid:522},this.SWITCH_SERVICE_TYPE={evid:523},this.PAYMENT_METHOD_MODAL_OPENED={evid:525},this.APPOINTMENT_BOOKED={evid:526},this.BOOKED_GROUP_BUT_NOT_PREMUIM={evid:527},this.ERROR={evid:524},this.CHANGE_STAFF_MEMBER_SELECTION={evid:529},this.CHOOSE_STAFF_MEMBER={evid:530},this.CHOOSE_STAFF_MEMBER_POPUP_OPENED={evid:531},this.PAYPAL_WINDOW_OPENED={evid:528},this.LOG_TIMEZONE={evid:532},this.PARTICIPANTS_AMOUNT_CHANGE={evid:533},this.TIMEZONE_SWITCH={evid:538},this.TIMEZONE_POPUP_OPENED={evid:539},this.DEEP_LINK_CALENDAR_OPEN={evid:541},this.LOGIN_CLICKED={evid:542},this.LOGIN_COMPLETE={evid:543},this.GO_TO_ACCOUNT_MANAGEMENT={evid:544}}return a}();a.AppEventMap=c;var d=function(){function a(){this.SETTINGS_OPENED={evid:160},this.SETTINGS_GET_STARTED={evid:142},this.SHOW_HIDE={evid:110},this.APP_SET_SCREENS_DROP_DOWN={evid:111},this.APP_SET_TAB_MENU_CLICK={evid:112},this.APP_SET_LAYOUT_SELECTION={evid:113},this.APP_SET_CATEGORY_MENU_SELECTION={evid:125},this.APP_SET_IMAGE_SELECTION={evid:126},this.APP_SET_PAGE_TITLE={evid:128},this.UPGRADE_CLICKED={evid:156},this.APP_SET_PATE_TITLE_SHOW={evid:143},this.SETTINGS_ADD_SERVICE={evid:165},this.SETTINGS_TEXT_CHANGED={evid:166},this.SETTINGS_STYLE_CHANGED={evid:167},this.SETTINGS_LAYOUT_TAB_POSITION_CHANGED={evid:168},this.SETTINGS_CLICK_ADD_WIDGET={evid:207},this.SETTINGS_MEMBER_LOGIN_TOGGLED={evid:221},this.SETTINGS_MEMBER_LOGIN_CLICKED={evid:222}}return a}();a.SettingsEventMap=d,angular.module("schedulerAngularClientAppConstants").constant("appEventMap",new c).constant("settingsEventMap",new d)}(b=a.bi||(a.bi={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a){this.$rootScope=a}return b.$inject=["$rootScope"],b.prototype.todayClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_TODAY)},b.prototype.bookIt=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKIT)},b.prototype.bookedGroupButNotPremium=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM)},b.prototype.googleCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT)},b.prototype.bookAnother=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER)},b.prototype.selectSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT)},b.prototype.cancellationPolicy=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY)},b.prototype.appointmentCreated=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED)},b.prototype.saveSuccessContactInfo=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS)},b.prototype.sendNext=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NEXT,b)},b.prototype.selectServiceType=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,b)},b.prototype.switchServiceType=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SWITCH_SERVICE_TYPE,b)},b.prototype.monthChangeClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_MOVE)},b.prototype.sendPaymentProcessOutcome=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PAYPAL_REDIRECT_DONE,b)},b.prototype.paymentMethodSelected=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PAYMENT_METHOD_SELECTED_MODAL,b)},b.prototype.openPaymentSelectionModal=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PAYMENT_METHOD_MODAL_OPENED,b)},b.prototype.servicesPageOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,b)},b.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},b.prototype.staffMemberSelectedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER)},b.prototype.staffMemberSelectionChangedFromCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION)},b.prototype.paypalWindoOpen=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PAYPAL_WINDOW_OPENED)},b.prototype.logTimezone=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE)},b.prototype.logParticipantsAmountChanged=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,b)},b.prototype.logPopupClosed=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,b)},b.prototype.timezoneSwitched=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,b)},b.prototype.logPopupOpened=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED)},b.prototype.logDeepLinkCalendarOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,b)},b.prototype.logLoginClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED)},b.prototype.logLoginComplete=function(b){var c=b.success,d=void 0===c?!1:c;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,{success:d})},b.prototype.logGoToAccountManagement=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT)},b}();b.VisitorBILogger=c,angular.module("schedulerAngularClientAppInternal").service("visitorBILogger",c)}(c=b.bi||(b.bi={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){angular.module("schedulerAngularClientAppConstants").constant("apiConst",{SCHEDULER_URL_PREFIX:"_api/scheduler-server"})}();var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=a.call(this,r,q,n,h,s)||this;v.$route=b,v.routeManager=c,v.flowManagerSrv=d,v.clientPages=e,v.businessInfoSrv=f,v.overEditor=g,v.visitorBILogger=i,v.$scope=j,v.TILE_LIST_EVENTS=k,v.wixBiLogger=l,v.TILE_IMAGE_SHAPE=m,v.ServiceTypes=o,v.experimentsEnabler=p,v.appSettings=s,v.IS_ONBOARDING=t,v.$filter=u,v.updateServicesPerCategory=function(a){v.services=v.updatePerCategory(a,v.serviceList.services)};var w=v;return v.groupsList=b.current.locals.groupList,v.serviceList=b.current.locals.serviceList,v.services=v.serviceList.services,h.updateModel(v.serviceList),v.categories=v.serviceList.categories,v.serviceImageType=s.getServiceTileImageType(v.categories.length),v.categoriesType=s.getIndividualCategoryLayout(v.categories.length),v.isNoServicesOverEditor=!1,v.showGroupsButton=v.showGroupServiceButton(),v.isOverEditor=g.isOverEditor,v.isNoServicesOverEditor=v.serviceList.dummy,f.gettingBusinessInfo(),j.$on(k.TILE_SELECTED,function(a,b){w.next(b)}),v}return __extends(b,a),b.$inject=["$route","routeManager","flowManagerSrv","clientPages","businessInfoSrv","overEditor","commonServices","visitorBILogger","$scope","TILE_LIST_EVENTS","wixBiLogger","TILE_IMAGE_SHAPE","SERVICE_CATEGORY_LAYOUT","ServiceTypes","experimentsEnabler","servicesSrv","groupsSrv","appSettings","IS_ONBOARDING","$filter"],b.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},b.prototype.next=function(a){this.flowManagerSrv.initiateIndividual(a),this.goToNextPage(),this.logServiceSelection()},b.prototype.goToNextPage=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},b.prototype.logServiceSelection=function(){this.visitorBILogger.bookIt()},b.prototype.isImagesShown=function(){return this.serviceImageType!==this.TILE_IMAGE_SHAPE.NONE},b.prototype.isPageTitleShown=function(){return!!this.$filter("wixSdkTranslate")("service-list-page-title","textPageTitle")},b.prototype.goToGroups=function(){this.visitorBILogger.switchServiceType(this.ServiceTypes.GROUP),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS)},b.prototype.showGroupServiceButton=function(){return this.hasGroupsServices()?!0:this.hasIndividualServices()||this.hasGroupsServices()?void 0:!0},b}(BaseServicesCtrl);a.ServicesCtrl=b,angular.module("schedulerAngularClientAppInternal").controller("ServicesCtrl",b)}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ServicesSrv=function(){function a(a,b,c,d,e){this.visitorApi=a,this.serviceConst=b,this.overEditor=c,this.boostInjectionPersister=d,this.$q=e}return a.$inject=["visitorApi","serviceConst","overEditor","boostInjectionPersister","$q"],a.prototype.gettingServices=function(){var a=this;return this.gettingRealServices().then(function(b){return a.hasServices(b)?b:a.overEditor.enrichServiceListIfOverEditor(b)})},a.prototype.hasRealServices=function(a){return this.hasServices(a)&&!a.services[0].dummy},a.prototype.hasServices=function(a){return a&&a.services&&a.services.length>0},a.prototype.gettingRealServices=function(){var a=this.boostInjectionPersister.getServicesList();return a?this.$q.when(a):this.visitorApi.gettingServices()},a.prototype.requireAddress=function(a){return a&&this.serviceConst.LOCATIONS_WITH_ADDRESS.indexOf(a.location)>-1},a.prototype.isDummyService=function(a){return this.overEditor.isOverEditor&&(!a||!a.id||a.dummy)},a}();angular.module("schedulerAngularClientAppInternal").service("servicesSrv",ServicesSrv);var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l){this.routeManager=a,this.clientPages=b,this.$route=c,this.appointmentService=d,this.servicesSrv=e,this.wixSdkUtil=f,this.wixBiLogger=g,this.commonServices=h,this.paymentService=i,this.visitorBILogger=j,this.$scope=k,this.userManagementSrv=l,this.submittedInvalid=!1,this.isPossessing=!1,this.businessInfo=c.current.locals.businessInfo,this.contactInfo=this.initObj(d.getContactInfo()),this.selectedService=this.initObj(d.getSelectedService()),this.selectedTime=this.initObj(d.getSelectedTime()),this.hasAddress=this.servicesSrv.requireAddress(this.selectedService),this.staff=c.current.locals.staff,this.timezone=this.$route.current.locals.timezone,this.paymentService.setBusinessInfo(this.businessInfo),this.saveContactOnPageChange(),this.initPaymentsForService()}return b.$inject=["routeManager","clientPages","$route","appointmentService","servicesSrv","wixSdkUtil","wixBiLogger","commonServices","paymentService","visitorBILogger","$scope","userManagementSrv"],b.prototype.isUserLoggedIn=function(){return this.userManagementSrv.isLoggedIn()},b.prototype.getLoggedContactInfo=function(){return this.userManagementSrv.getCurrentSiteMember()},b.prototype.isNextActionAllowed=function(a){return a.$valid&&!this.isPossessing},b.prototype.isMobileFlow=function(){return!1},b.prototype.doNext=function(a){var b=this;if(this.savedOnNext=!1,this.submittedInvalid=a.$invalid,this.wixSdkUtil.resetHeight(),this.visitorBILogger.sendNext("contact_info"),!a.$invalid){if(this.appointmentService.setContactInfo(this.contactInfo),this.appointmentService.persist(this.selectedService),this.savedOnNext=!0,this.visitorBILogger.saveSuccessContactInfo(),this.isLastStepInFlow())return this.isPossessing=!0,this.paymentService.handle().then(this.appointmentService.save).then(function(){b.goToFlowEnd()})["catch"](function(a){return b.errorCallback(a)});this.goToNextStep()}return!a.$invalid},b.prototype.initPaymentsForService=function(){var a=this;this.isMobileFlow()||(this.isPossessing=!0,this.paymentService.initPaymentsForService(this.selectedService).then(function(){a.isPossessing=!1}))},b.prototype.goToNextStep=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONFIRMATION)},b.prototype.isLastStepInFlow=function(){return!0},b.prototype.errorCallback=function(b){this.isPossessing=!1,this.showErrorKey=null,this.appointmentService.isConflictingAppointment(b)?this.showErrorKey="visitor.confirmation.error.already-booked":b===a.boost.visitor.payments.PaypalStatus.PAYPAL_BLOCKED?this.showErrorKey="visitor.confirmation.error.paypal-is-blocked":b===a.boost.visitor.payments.PaypalStatus.PAYPAL_CANCELLED?this.showErrorKey="visitor.confirmation.error.paypal-is-cancelled":b===a.boost.visitor.payments.StripeStatus.STRIPE_CANCELLED&&(this.showErrorKey="visitor.confirmation.error.stripe-is-cancelled"),this.showError=null!==this.showErrorKey},b.prototype.doBack=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},b.prototype.goToFlowEnd=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONGRATS)},b.prototype.getTimezone=function(){return this.timezone},b.prototype.initObj=function(a){return a?a:{}},b.prototype.saveContactOnPageChange=function(){var a=this;this.$scope.$on("$destroy",function(){a.savedOnNext||a.appointmentService.setContactInfo(a.contactInfo)})},b.prototype.getSelectedService=function(){return this.selectedService},Object.defineProperty(b.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),b}();b.ContactInfoController=c,angular.module("schedulerAngularClientAppInternal").controller("ContactInfoCtrl",c)}(c=b.pages||(b.pages={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var BusinessInfoSrv=function(){function a(a,b,c,d,e){this.visitorApi=a,this.cacheSrv=b,this.$q=c,this.overEditor=d,this.boostInjectionPersister=e}return a.$inject=["visitorApi","cacheSrv","$q","overEditor","boostInjectionPersister"],a.prototype.setBusinessInfo=function(a){return this.cacheSrv.setToCache("businessInfo",a)},a.prototype.getBusinessInfo=function(){var a=this.cacheSrv.getFromCache("businessInfo");return this.overEditor.enrichBusinessInfoIfOverEditor(a),a},a.prototype.gettingBusinessInfo=function(){var a=this,b=this.$q.defer(),c=this.getBusinessInfo();return c?b.resolve(c):this.gettingNewBusinessInfo().then(function(c){return a.setBusinessInfo(c),b.resolve(a.overEditor.enrichBusinessInfoIfOverEditor(c))}),b.promise},a.prototype.gettingNewBusinessInfo=function(){var a=this.boostInjectionPersister.getBusinessInfo();return a?this.$q.when(a):this.visitorApi.gettingBusinessInfo()},a}();angular.module("schedulerAngularClientAppInternal").service("businessInfoSrv",BusinessInfoSrv);var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a,b,c,d,e,f,g,h,i,j,k){this.businessInfo=a,this.clientPages=b,this.routeManager=c,this.servicesSrv=d,this.appointmentService=e,this.momentSrv=f,this.timezoneSrv=g,this.wixBiLogger=h,this.commonServices=i,this.paymentService=j,this.visitorBILogger=k,this.renderTimezone=null,this.isPossessing=!1,this.participantsVisibility=!1,this.paymentService.setBusinessInfo(a),this.init()}return b.$inject=["businessInfo","clientPages","routeManager","servicesSrv","appointmentService","momentSrv","timezoneSrv","wixBiLogger","commonServices","paymentService","visitorBILogger"],b.prototype.doBackService=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},b.prototype.doBackContactInformation=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONTACT_INFO)},b.prototype.getLocation=function(){return this.appointmentService.getAppointmentLocation()},b.prototype.getLocationText=function(){return this.appointmentService.getAppointmentLocationText()},b.prototype.getMinCharge=function(){return this.selectedService.minCharge},b.prototype.getCurrency=function(){return this.selectedService.currency},b.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a},b.prototype.sendSaveAppointemntBi=function(){this.visitorBILogger.sendNext("Confirmation"),this.wixBiLogger.log(this.wixBiLogger.events.NEXT,{price_selection:this.selectedService.isFree?"price_free":"price_paid",referal_info:"Confirmation",price:this.commonServices.decorateServicePriceForBi(this.selectedService),currency:this.selectedService.currency,categoryId:this.selectedService.categoryId,serviceId:this.selectedService.id})},b.prototype.errorCallback=function(b){this.isPossessing=!1,this.showErrorKey=null,this.appointmentService.isConflictingAppointment(b)?this.showErrorKey="visitor.confirmation.error.already-booked":b===a.boost.visitor.payments.PaypalStatus.PAYPAL_BLOCKED?this.showErrorKey="visitor.confirmation.error.paypal-is-blocked":b===a.boost.visitor.payments.PaypalStatus.PAYPAL_CANCELLED?this.showErrorKey="visitor.confirmation.error.paypal-is-cancelled":b===a.boost.visitor.payments.StripeStatus.STRIPE_CANCELLED&&(this.showErrorKey="visitor.confirmation.error.stripe-is-cancelled"),this.showError=null!==this.showErrorKey},b.prototype.saveAppointment=function(){var a=this;return this.sendSaveAppointemntBi(),this.isPossessing=!0,this.paymentService.handle().then(this.appointmentService.save).then(function(){a.goToNext()})["catch"](function(b){return a.errorCallback(b)})},b.prototype.goToNext=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONGRATS)},b.prototype.init=function(){this.contactInfo=this.appointmentService.getContactInfo(),this.selectedTime=this.appointmentService.getSelectedTime(),this.selectedService=this.appointmentService.getSelectedService(),this.hasAddress=this.servicesSrv.requireAddress(this.selectedService),this.showError=!1,this.resolvedAppointmentTime(),this.addressKey="visitor.confirmation.booking-summary.business-info",this.staffMemberName=this.getStaffMemberName(),this.isToShowUpfrontPayment=!0},b.prototype.resolvedAppointmentTime=function(){this.setTimes()},b.prototype.setTimes=function(){var a=this.selectedTime,b=a.startTime,c=a.endTime,d=a.timeZone;this.selectedTime.startTime=this.momentSrv.timestampToMomentInTimezone(b,d),this.selectedTime.endTime=this.momentSrv.timestampToMomentInTimezone(c,d)},b.prototype.updateIsToShowUpfrontPayment=function(a){this.isToShowUpfrontPayment=a},b.prototype.getStaffMemberName=function(){return this.selectedTime.staffMember?this.selectedTime.staffMember.fullName:this.selectedTime.groupInstance?this.selectedTime.groupInstance.teacher:""},b}();b.VisitorConfirmationCtrl=c}(c=b.confirmation||(b.confirmation={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),angular.module("schedulerAngularClientAppInternal").controller("VisitorConfirmationController",wix.boost.visitor.confirmation.VisitorConfirmationCtrl),function(){function a(a,b,c,d){function e(){return b.SCHEDULER_URL_PREFIX}function f(a){var b="";return a.type===d.GROUP&&(b="/"+(a.numberOfParticipants||1)),b}this.gettingBusinessInfo=c.httpWrapper(function(){return a.get(e()+"/visitor/business/")}),this.gettingServices=c.httpWrapper(function(){return a.get(e()+"/visitor/services/")}),this.gettingCalendarInfo=c.httpWrapper(function(b){var c=b.start.getTime(),d=b.end.getTime();return a.get(e()+"/visitor/appointments/"+c+"/"+d)}),this.creatingAppointment=c.httpWrapper(function(b){return a.post(e()+"/visitor/appointments/",b)}),this.registeringToGroup=c.httpWrapper(function(b){return a.post(e()+"/visitor/classes/register/",b)}),this.updatingLanguage=c.httpWrapper(function(b){return a.put(e()+"/owner/business/language",b)}),this.gettingPaypalUrlForService=c.httpWrapper(function(b){var c=b.id,d=f(b);return a.get(e()+"/visitor/payment/"+c+"/paypal"+d)}),this.gettingStripeDetailsForService=c.httpWrapper(function(b){var c=b.id,d=f(b);return a.get(e()+"/visitor/payment/"+c+"/stripe"+d)}),this.notifyingNonPremiumEnrollmentAttempt=c.httpWrapper(function(){return a.post(e()+"/visitor/classes/nonPremium")}),this.getSlotsAvailability=c.httpWrapper(function(b){var c=b.range.start.format("x"),d=b.range.end.format("x"),f=b.timeZone,g=b.duration;return a.get(e()+"/visitor/slots/"+c+"/"+d+"?tz="+f+"&duration="+g)}),this.gettingGroupsInstances=c.httpWrapper(function(b){var c=b.dateRange,d=b.id,f=c.start.valueOf(),g=c.end.valueOf();return a.get(e()+"/visitor/classes/inst/"+d+"/"+f+"/"+g)}),this.gettingGroups=c.httpWrapper(function(){return a.get(e()+"/visitor/classes/proto")}),this.getFirstAvailableSlotForIndividualService=c.httpWrapper(function(b){var c=b.timezone,d=b.serviceId;return a.get(e()+"/visitor/slots/nextAvailable/"+d+"?tz="+c)}),this.getFirstAvailableSlotForGroupPrototype=c.httpWrapper(function(b){var c=b.groupProtoId;return a.get(e()+"/visitor/classes/inst/nextAvailable/"+c)}),this.gettingStaffMembers=c.httpWrapper(function(){return a.get(e()+"/visitor/staff/")}),this.getAvailableSlotsForIndividualService=c.httpWrapper(function(b){var c=b.range.start.format("x"),d=b.range.end.format("x"),f=b.timeZone,g=b.serviceId;return a.get(e()+"/visitor/staff/slots/"+g+"/"+c+"/"+d+"?tz="+f)})}a.$inject=["$http","apiConst","commonApiBase","ServiceTypes"],angular.module("schedulerAngularClientCommon").service("visitorApi",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$window=a,this.$q=b,this.appointmentService=c,this.servicesSrv=d,this.routeManager=e,this.clientPages=f,this.libs=g,this.visitorBILogger=h,this.cacheSrv=j,this.paymentType=k,this.experimentsEnabler=l,this.participantsVisibility=!1,this.businessInfo=i.current.locals.businessInfo,this.addressKey=this.businessInfo.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt",this.staff=i.current.locals.staff,this.serviceInfo=this.appointmentService.getSelectedService(),this.appointmentTime=this.appointmentService.getSelectedTime(),this.address=this.getAppointmentLocation(this.serviceInfo),this.showUpfrontPayment=this.populateIsToShowUpfrontPayment()}return a.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","libs","visitorBILogger","$route","cacheSrv","paymentType","experimentsEnabler"],Object.defineProperty(a.prototype,"appointmentLocationText",{get:function(){return this.concatinateAddressString(this.address,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"appointmentLocation",{get:function(){return this.appointmentService.getAppointmentLocation(this.serviceInfo,this.appointmentTime)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dayOfMonth",{get:function(){return this.momentOfStartTime.format("D")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"month",{get:function(){return this.momentOfStartTime.format("MMM")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dayOfWeek",{get:function(){return this.momentOfStartTime.format("ddd")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){return this.momentOfStartTime.format("h:mm A")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"momentOfStartTime",{get:function(){var a=this.appointmentTime,b=a.startTime,c=a.timeZone;return this.appointmentTime?this.libs.moment.tz(+b,c):this.libs.moment()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"staffName",{get:function(){return this.appointmentTime&&this.appointmentTime.staffMember&&this.staff&&this.staff.staff.length>1?this.appointmentTime.staffMember.fullName:""},enumerable:!0,configurable:!0}),a.prototype.isToShowUpfrontPayment=function(){return this.showUpfrontPayment},a.prototype.getMinCharge=function(){return this.serviceInfo.minCharge},a.prototype.getSelectedNumberOfParticipants=function(){return this.serviceInfo.numberOfParticipants||1},a.prototype.isMultipleParticipants=function(){return!1},a.prototype.getCurrency=function(){return this.serviceInfo.currency},a.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a,this.cacheSrv.clearKey("appointmentDateTime")},a.prototype.populateIsToShowUpfrontPayment=function(){return this.appointmentService.getPaymentType()!==this.paymentType.PAYMENT_TYPE_OFFLINE},a.prototype.formatDate=function(a){return this.libs.moment(parseInt(a,10)).toDate().toISOString().replace(/-|:|\.\d+/g,"")},a.prototype.createGoogleCalendarUrlForAppointment=function(a){var b=this.formatDate(a.time.startTime),c=this.formatDate(a.time.endTime),d=encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(a.title||""),"&dates="+(b||""),"/"+(c||""),"&location="+(a.location||""),"&sprop=&sprop=name:"].join(""));return d},a.prototype.concatinateAddressString=function(a,b){void 0===b&&(b=!1);var c=[];return Object.keys(a).filter(function(a){return"city"!==a||!b&&"city"===a?!0:!1}).forEach(function(b){c.push(a[b])}),c.join(", ")},a.prototype.handleLocationTextGiven=function(a){return{text:a}},a.prototype.getBusinessAddress=function(){return{street:this.businessInfo.address,city:this.businessInfo.city,apartmentNum:this.businessInfo.apartmentNum}},a.prototype.getAppointmentLocation=function(a){var b=this.servicesSrv.requireAddress(a),c=a.locationText;return b?this.appointmentService.getContactInfo().address:c?this.handleLocationTextGiven(c):this.getBusinessAddress()},a.prototype.redirectToGoogleCalendar=function(){this.visitorBILogger.googleCalendar();var a={title:this.serviceInfo.name,time:this.appointmentTime},b=this.getAppointmentLocation(this.serviceInfo);return a.location=this.concatinateAddressString(b),this.$window.open(this.createGoogleCalendarUrlForAppointment(a),"GoogleCalendar"),a},a.prototype.doAddAnother=function(){this.visitorBILogger.bookAnother(),this.routeManager.gotoPage(this.bookAnotherPage)},a.getTemplateUrl=function(a){return a?"modules/congratulations-page/congratulations-old.preload.html":"modules/congratulations-page/congratulations.preload.html"},a.prototype.isShowLocation=function(){return this.appointmentService.isShowBusinessAddress(this.serviceInfo,this.appointmentTime,this.businessInfo,!0)},a.prototype.getCity=function(){return"CUSTOMER"===this.serviceInfo.location?this.address.city:this.appointmentService.getBusinessCity(this.businessInfo,this.serviceInfo,this.appointmentTime)},a}();a.CongratulationsController=b,angular.module("schedulerAngularClientAppInternal").controller("CongratulationsController",b)}(b=a.pages||(a.pages={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.cache={}}return a.prototype.getFromCache=function(a){return this.cache[a]},a.prototype.setToCache=function(a,b){this.cache[a]=b},a.prototype.clearKey=function(a){this.cache[a]=void 0},a.prototype.clearCache=function(){this.cache={}},a}(),c=function(){function a(a){this.$window=a}return a.$inject=["$window"],a.prototype.isWebStorageSupported=function(){try{var a="SessionStorageCacheSrvTestKey";this.$window.sessionStorage.setItem(a,"OK");var b=this.$window.sessionStorage.getItem(a);return this.$window.sessionStorage.removeItem(a),"OK"===b}catch(c){return!1}},a.prototype.getFromCache=function(a){return this.$window.sessionStorage.getItem(a)},a.prototype.setToCache=function(a,b){this.$window.sessionStorage.setItem(a,b);
},a.prototype.clearKey=function(a){this.$window.sessionStorage.removeItem(a)},a.prototype.clearCache=function(){this.$window.sessionStorage.clear()},a}(),d=function(){function a(a,b,c){this.$wix=a,b.isWebStorageSupported()?this.stringsCache=b:this.stringsCache=c}return a.$inject=["$wix","sessionStorageCacheSrv","inMemoryCacheSrv"],a.prototype.getCacheKey=function(a){return a},a.prototype.getFromCache=function(a){var b=this.stringsCache.getFromCache(this.getCacheKey(a));return angular.fromJson(b)},a.prototype.setToCache=function(a,b){this.stringsCache.setToCache(this.getCacheKey(a),angular.toJson(b))},a.prototype.clearKey=function(a){this.stringsCache.clearKey(this.getCacheKey(a))},a.prototype.clearCache=function(){this.stringsCache.clearCache()},a}();a.CacheSrv=d,angular.module("schedulerAngularClientAppInternal").service("cacheSrv",d).service("inMemoryCacheSrv",b).service("sessionStorageCacheSrv",c)}(b=a.utils||(a.utils={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(a){var b,c,d=a.fullCalendar;if(d){b=d.Grid.prototype.headCellHtml,c=d.Grid.prototype.bindHandlers,a.extend(d.Grid.prototype,{headCellHtml:function(c){var d=this.view,e=c.start,f=d.calendar.getNow().stripTime(),g=e.isSame(f,"day")?"fc-today":"",h=b.call(this,c);return g?(h=a(h),a(h).addClass(g),h[0].outerHTML):h},bindHandlers:function(){function b(b){var c=a(b);return c.hasClass("fc-highlight")||c.hasClass("fc-hovered-over")}var d=this,e=this.view.opt("hoverEffect"),f=this.view.opt("defaultEventMinutes");a(".fc-view-container").mouseleave(function(){d.destroyHover()}),a(".fc-slats tr").mouseenter(function(c){var g=a(c.target);if(a(".fc-hover-skeleton").length&&d.destroyHover(),e&&!b(c.target)){d.coordMap.build();var h=d.coordMap.getCell(c.pageX,c.pageY);if(null!==h&&void 0!==h.day){var i={};i.col=void 0,i.row=h.row,i.start=h.start.clone(),i.day=h.day.clone(),i.grid=h.grid,i.end=h.start.add(f,"m");var j=d.computeSelection(h,i);null!==j&&(g.addClass("fc-hovered-over"),d.renderHover(j))}}}),c.call(this)},hoverSegClasses:function(){return["fc-hover"]},renderHover:function(a){this.renderFill("hover",this.rangeToSegs(a))},destroyHover:function(){this.destroyFill("hover"),a(".fc-widget-content").removeClass("fc-hovered-over")}});var e=a.fullCalendar.views.agenda.prototype.initialize;a.extend(a.fullCalendar.views.agenda.prototype,{initialize:function(){e.call(this),this.timeGrid.renderSelection=function(a){var b=this.view.opt("defaultEventMinutes"),c={};c.end=a.start.clone().add(b,"m"),c.start=c.end.clone();var d=this.computeSelection(a,c);null!==d&&(a.end=c.end,this.renderHighlight(a))}}})}}(jQuery);var scheduler;!function(a){var b;!function(a){function b(a){function b(b,c){var d=a.getTextForModel(c+"_Checkbox");return"false"===d?"":a.getTextForModel(c,b)}return b.$stateful=!0,b}b.$inject=["wixSdkUtil"],a.wixSdkTranslate=b,angular.module("wixSdkUtilInternal").filter("wixSdkTranslate",b)}(b=a.filter||(a.filter={}))}(scheduler||(scheduler={})),function(){function a(a){function b(b,c){var d=a.getTextForModel(c+"_Checkbox");return"false"===d?"":a.getTextForModel(c,b)}return b.$stateful=!0,b}a.$inject=["wixSdkUtil"],angular.module("wixSdkUtilInternal").filter("wixSdkTranslate",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;p.REDIRECT_TO_PAGE_WHEN_NAVIGATING_AWAY="default-page";try{this.isOverEditor=a.isOverEditor()}catch(q){this.isOverEditor=!1}try{this.isInEditingMode=a.isInEditingMode()}catch(q){this.isInEditingMode=!1}try{this.isDemoMode=a.Utils.getDemoMode()}catch(q){this.isDemoMode=!1}this.isDemoFlow=this.isDemoMode||this.isOverEditor;var r=[];if(n.isMultipleCalendarsEnabled())for(var s=1;4>s;s++)r.push({id:"dummy-staff-"+s,fullName:b("over-editor.staff-name-"+s)});this.enrichStaffIfOverEditor=function(a){this.isOverEditor&&!a.staff.length&&(a.staff=r)},this.enrichServiceIfOverEditor=function(a){return this.isOverEditor&&!a?{name:b("service-name-editor-selected"),duration:parseInt(b("service-duration-editor")),price:parseInt(b("service-price-editor")),currency:b("service-currency-editor"),capacity:5,dummy:!0,type:l.GROUP,location:"CUSTOMER",maxParticipantsPerOrder:1}:a},this.enrichGroupListIfOverEditor=function(a){if(this.isOverEditor){for(var c=3,d=[],e=[],f=1;4>f;f++)e.push({id:"cat_id_"+f,order:f,name:b("category-name-editor-"+f)});for(var g=0;c>g;g++)d.push({id:g,capacity:5,name:b("group-name-editor"),duration:+b("group-duration-editor"),currency:b("group-currency-editor"),categoryId:"cat_id_"+(Math.floor(g/3)+1),price:+b("group-price-editor"),description:b("group-description-editor"),classHours:{mon:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:"Shera"}]},tue:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},wed:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},thu:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},fri:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},sat:null,sun:null},dummy:!0,showFullText:!1,images:k.imagesList[g].images});return{classes:d,categories:[]}}return a},this.enrichBusinessInfoIfOverEditor=function(a){if(this.isOverEditor){var c=a;return c&&!c.name&&(c.name=b("over-editor.mock-business-name"),c.address=b("over-editor.mock-business-address")),c}return a},this.enrichSelectedTimeIfOverEditor=function(a){var b=a;if(this.isOverEditor){if(!b){var c=e.moment().hour(12).minutes(0).seconds(0),d=e.moment().hour(12).minutes(45).seconds(0);b={startTime:c.format("x"),endTime:d.format("x")}}b.groupInstance||(b.groupInstance={id:"id_0"})}return b},this.enrichContactIfOverEditor=function(a){return this.isOverEditor&&!a?{name:b("over-editor.mock-contact.name"),email:b("over-editor.mock-contact.email"),phone:b("over-editor.mock-contact.phone"),address:{addressLine:b("over-editor.mock-contact.address"),aptOrFloor:b("over-editor.mock-contact.apt"),city:b("over-editor.mock-contact.city")}}:a},this.enrichServiceListIfOverEditor=function(a){var c=9,d=[],e=[];if(this.isOverEditor){for(var f=0;c>f;f++)d.push({id:f,name:b("service-name-editor-"+(f%3+1)),duration:+b("service-duration-editor"),currency:b("service-currency-editor"),price:+b("service-price-editor"),description:b("service-description-editor"),dummy:!0,categoryId:"cat_id_"+(Math.floor(f/3)+1),showFullText:!1,images:j.imagesList[f].images});for(var g=1;4>g;g++)e.push({id:"cat_id_"+g,order:g,name:b("category-name-editor-"+g)});return{services:d,categories:e,dummy:!0}}return a},this.getClassesInstancesIfOverEditor=function(a,c){var d=[];if(this.isOverEditor){var e=c.staff.length?c.staff:r;0===e.length&&e.push({});for(var f=a.start,g=0;25>g;g++){var h=g%5+g%2;h=5===h?1:h;for(var i=0;i<e.length;i++){var j={id:"id_"+g,capacity:5,classProtoId:g,registered:g%7,teacher:b("group-teacher-editor"),staffMemberId:e[i].id,start:f.clone().startOf("isoWeek").add(h,"day").hour(g%12+6).valueOf(),end:f.clone().startOf("isoWeek").add(h,"day").hour(g%12+7).valueOf()};d.push(j)}}}return{classesInstances:d}},this.getFirstAvailableSlotForService=function(){return e.moment()},this.getSlotsAvailability=function(a,b,c,d){for(var f={},g=e.moment.tz(a.start,b).startOf("month"),h=g.clone(),i=c.staff.length?c.staff:r,j=0;d>j;j++){var k=f[g.format("x")]=[],l=[];if(j%3===0){for(var m=0;m<i.length;m++)k.push({staffId:i[m].id,slots:l});for(var n=0;40>n;n++)h.add(30,"minutes"),l.push(h.valueOf());h.startOf("day")}g.add(1,"days"),h=g.clone()}return f},this.isEditModeAndNotVisitedOwner=function(){return!m.isVisitedOwner()&&this.isInEditingMode},this.isOverEditor&&(a.addEventListener(a.Events.EDIT_MODE_CHANGE,function(a){"preview"===a.editMode&&f.location.reload()}),a.addEventListener(a.Events.SETTINGS_UPDATED,function(a){i(function(){var b=d.getTextForModel("previewPage");a===g.PREVIEW_UPDATE?o.path().endsWith(b)||c.gotoPage(b):a===g.OWNER_OVER_EDITOR_CHANGE?(h.clearCache(),c.gotoPage(b),f.location.reload()):(a===g.LANGUAGE_CHANGE||a===g.LAYOUT_CHANGE)&&(c.gotoPage(b),f.location.reload())},150)}))}a.$inject=["$wix","$translate","routeManager","wixSdkUtil","libs","$window","eventsConst","cacheSrv","$timeout","SERVICE_EDITOR_DEFAULTS","GROUP_EDITOR_DEFAULTS","ServiceTypes","entryPointsIndicator","experimentsEnabler","$location"],angular.module("schedulerAngularClientAppInternal").service("overEditor",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$wix=a,this.deviceType=a.Utils.getDeviceType(),this.isMobile="mobile"===this.deviceType.toLowerCase()}return a.$inject=["$wix"],a.prototype.getIsMobile=function(){return this.isMobile},a}();a.AppConfig=b,angular.module("schedulerAngularClientAppInternal").service("appConfig",b)}(b=a.services||(a.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.appSettings=a,this.SERVICE_CATEGORY_LAYOUT=b,this.columnsAmountToClass={1:"service--single",2:"service--even",3:"service--odd"}}return a.prototype.mapColumnsAmountToClass=function(){return this.columnsAmountToClass[this.columnsAmount]},a.prototype.getTileSize=function(){return this.getCategoryPlacement()===this.SERVICE_CATEGORY_LAYOUT.VERTICAL&&1===this.columnsAmount||this.columnsAmount>2?"small":"large"},a.prototype.getCategoryPlacement=function(){},a}();a.ServicesList=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.tileTemplate=b.getServiceListTemplate(),d.tileConfig=b.getServiceTileConfig(),d.columnsAmount=b.getNumberOfColumns(d.tileTemplate,b.getCategoryLayoutType(d.individualCategories)),d.serviceItemClass=d.mapColumnsAmountToClass(),d}return __extends(b,a),b.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],b.prototype.getCategoryPlacement=function(){return this.appSettings.getCategoryLayoutType(this.individualCategories)},b}(a.ServicesList);angular.module("schedulerAngularClientAppInternal").component("boostIndividualServicesList",{controller:b,templateUrl:"modules/visitor/services/services-list.preload.html",bindings:{services:"=",individualCategories:"="}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var CategoryListCtrl=function(){function a(){this.categories&&this.categories[0]&&this.categoryChanged(this.categories[0].id)}return a.prototype.categoryChanged=function(a){this.selectedCategoryId=a,this.callbackFunc(a)},a}();!function(){function a(){return{scope:{callbackFunc:"=onChangeCategoryCallback",categories:"=",type:"@"},templateUrl:"modules/visitor/services/services-categories-list.preload.html",restrict:"E",controller:"CategoryListController",controllerAs:"$ctrl",bindToController:!0}}angular.module("schedulerAngularClientAppInternal").controller("CategoryListController",CategoryListCtrl).directive("boostCategoryList",a)}(),function(){function a(){return{scope:{service:"=",size:"@",template:"@",serviceDays:"=",tileConfig:"=config",buttonText:"@",customClass:"@"},controller:"serviceTileController",controllerAs:"stCtrl",template:"<ng-include style=\"width:100%\" src=\"'modules/service-tile/'+stCtrl.template+'/service-'+stCtrl.template+'.preload.html'\"/>",bindToController:!0,transclude:!0,restrict:"EA"}}angular.module("schedulerAngularClientAppInternal").directive("boostServiceTile",a)}();var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f){var g=a.call(this,b,e)||this;return g.$scope=c,g.TILE_LIST_EVENTS=d,g.wixBiLogger=f,g.showDescriptionContainer=!1,g}return __extends(b,a),b.$inject=["TILE_IMAGE_SHAPE","$scope","TILE_LIST_EVENTS","commonServices","wixBiLogger"],b.prototype.getImageUrl=function(){return a.prototype.getImageUrl.call(this,this.service.images,this.tileConfig.imageSize)},b.prototype.selectTile=function(a){a&&a.stopImmediatePropagation(),this.$scope.$emit(this.TILE_LIST_EVENTS.TILE_SELECTED,this.service)},b.prototype.logShowMore=function(){this.wixBiLogger.log(this.wixBiLogger.events.MORE,{service_id:this.service.id})},b.prototype.toggleDescription=function(){this.service.description&&(this.showDescriptionContainer=!this.showDescriptionContainer)},b.prototype.applyChanges=function(){return this.$scope.$apply()},b}(a.BaseTileController);a.ServiceTileController=b,angular.module("schedulerAngularClientAppInternal").controller("serviceTileController",b)}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var BoostInjectionPersister=function(){function a(a){this.provider=a}return a.$inject=["provider"],a.prototype.getServicesList=function(){return this.provider.servicesList},a.prototype.getGroupsList=function(){return this.provider.groupsList},a.prototype.getBusinessInfo=function(){return this.provider.businessInfo},a.prototype.getStaff=function(){return this.provider.staff},a.prototype.getCurrentMember=function(){return this.provider.currentMember},a}(),BoostInjectionPersisterProvider=function(){function a(){}return a.prototype.setServicesList=function(a){this.servicesList=this.safeReadInjectedAttribute(a)},a.prototype.setGroupsList=function(a){this.groupsList=this.safeReadInjectedAttribute(a)},a.prototype.setBusinessInfo=function(a){this.businessInfo=this.safeReadInjectedAttribute(a)},a.prototype.setStaff=function(a){this.staff=this.safeReadInjectedAttribute(a)},a.prototype.setCurrentMember=function(a){this.currentMember=this.safeReadInjectedAttribute(a,{})},a.prototype.safeReadInjectedAttribute=function(a,b){void 0===b&&(b=null);try{return angular.fromJson(a)}catch(c){return console.warn("Missing injection from Bookings server",a),b}},a.prototype.$get=function(a){return a.instantiate(BoostInjectionPersister,{provider:this})},a.prototype.$get.$inject=["$injector"],a}();angular.module("schedulerAngularClientAppInternal").provider("boostInjectionPersister",BoostInjectionPersisterProvider);var wix;!function(a){var b;!function(b){var c;!function(b){var c=function(){function a(a,b,c,d){this.$modal=a,this.$wix=b,this.$location=c,this.$window=d}return a.$inject=["$modal","$wix","$location","$window"],a.prototype.openDetails=function(a){return a.animation=!0,this.$modal.open(a)},a.prototype.openClassEnrollmentPromotion=function(){var a,b=this;a=9100===this.$location.port()&&this.$location.host().indexOf("local")>-1?"http://localhost:9000/class-enrollment-promo.html":this.$location.protocol()+"://"+this.$location.host()+"/classes-promo.html",this.$wix.openBareModal(a,564,610,function(){b.$window.location.reload()})},a}();b.Modal=c,angular.module("schedulerAngularClientAppInternal").service("modal",a.boost.services.Modal)}(c=b.services||(b.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.$modalInstance=a,this.businessInfo=b,this.paymentService=c,this.visitorBILogger=d,this.appointmentService=e,this.paymentService.setBusinessInfo(b),this.isPaypalAllowed=this.paymentService.isPayPalPaymentEnabled(),this.isStripeAllowed=this.paymentService.isStripePaymentEnabled(),this.isOfflineAllowed=this.paymentService.isOfflinePaymentAllowed(),this.visitorBILogger.openPaymentSelectionModal({stripe:this.isStripeAllowed,paypal:this.isPaypalAllowed,offline:this.isOfflineAllowed})}return a.$inject=["$modalInstance","businessInfo","paymentService","visitorBILogger","appointmentService"],a.prototype.optionSelected=function(){this.paymentType&&(this.sendSelectionBi(),this.appointmentService.setPaymentType(this.paymentType),this.$modalInstance.close(this.paymentType))},a.prototype.close=function(){this.$modalInstance.dismiss()},a.prototype.sendSelectionBi=function(){this.visitorBILogger.paymentMethodSelected(this.paymentType)},a}();a.SelectPaymentOptionController=b,angular.module("schedulerAngularClientAppInternal").controller("SelectPaymentOptionController",b)}(b=a.payments||(a.payments={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(b,c,d,e,f,g,h,i,j,k,l){var m=this;this.$scope=b,this.$rootScope=c,this.$element=d,this.CALENDAR_EVENTS=e,this.libs=f,this.slotsSrv=g,this.$q=h,this.DateDefaults=i,this.visitorBILogger=k,this.momentSrv=l,this.isInWeeklyMode=!1,this.eventsSource=[],this.calendarConfig={header:!1,firstDay:1,contentHeight:"auto",viewRender:function(){m.onCalendarRendered()},dayClick:function(a){a=m.momentSrv.createMomentWithSameTimeInDifferentTimeZone(a,m.timezone);var b=moment.tz(m.timezone);a.isSameOrAfter(b,"day")&&m.selectDate(a)},eventRender:function(b,c,d){m.findElementsByDate(b.start).addClass(a.AVAILABLE_DAYS_CLASS)}},this.onSelectDate=function(a,b){m.calendarRenderedPromise.promise.then(function(){return m.goToMonth(b)}).then(function(){m.selectDate(b)}).then(function(){m.scrollToWeekOfDay(b)})["catch"](function(){console.log("ERROR!")})},this.switchToWeekMode=function(){if(m.calendarAPI.switchToWeekView(),m.resetViewOffset(),m.$element.addClass(a.WEEKLY_MODE_CLASS),m.hoverDate){var b=$('[data-date="'+m.hoverDate+'"].fc-day').parents(".fc-week");m.scrollElementIntoView(b[0])}m.setWeekRange(),m.isInWeeklyMode=!0},this.goToNextMonth=function(){m.calendarAPI.goToNextMonth(),m.onMonthChanged()},this.goToToday=function(){m.visitorBILogger.todayClick(),m.calendarAPI.goToToday(),m.updateCurrentViewRange(),m.notifyMonthChanged(),m.resetViewOffset(),m.isInWeeklyMode&&(m.goToTodayInWeekMode(),m.calendarAPI.switchToWeekView())},this.goToPrevMonth=function(){m.calendarAPI.goToPrevMonth(),m.onMonthChanged()},this.switchToMonthMode=function(){m.calendarAPI.switchToMonthView(),m.resetViewOffset(),m.notifyMonthChanged(),m.$element.removeClass(a.WEEKLY_MODE_CLASS),m.isInWeeklyMode=!1},this.goToNextWeek=function(){m.currentWeek.start=m.currentWeek.start.clone().add(1,"week"),m.currentWeek.end=m.currentWeek.end.clone().add(1,"week"),m.isNextWeekOutOfCurrentRange()?m.goToFirstUnseenDatesOfNextMonth():m.animateRight(m.calendarSingleWeekWidth),m.notifyWeekChanged()},this.goToPrevWeek=function(){m.currentWeek.start=m.currentWeek.start.clone().subtract(1,"week"),m.currentWeek.end=m.currentWeek.end.clone().subtract(1,"week"),m.isPreviousWeekOutOfCurrentRange()?m.goToFirstUnseenDatesOfPreviousMonth():m.animateLeft(m.calendarSingleWeekWidth),m.notifyWeekChanged()},this.calendarAPI=j.create(this.$element.children().first(),this.timezone),this.calendarRenderedPromise=h.defer(),this.registerListeners()}return a.$inject=["$scope","$rootScope","$element","CALENDAR_EVENTS","libs","slotsSrv","$q","DateDefaults","FullCalendarAdapterFactory","visitorBILogger","momentSrv"],a.prototype.goToMonth=function(a){return this.calendarAPI.goToDate(a),this.updateCurrentViewRange(),this.updateSlotsAvailability()},a.prototype.scrollToWeekOfDay=function(a){var b=this.findElementsByDate(a).parents(".fc-week");this.scrollElementIntoView(b)},a.prototype.onCalendarRendered=function(){var a=this;this.onReady();var b;this.retrieveCalendarProperties(),this.onMonthChanged(),this.notifyLowerBound(this.currentViewRange.end),this.calendarRenderedPromise.resolve(),$(document).on("mouseover",".fc-week .fc-day",function(c){var d=angular.element(c.currentTarget);d.addClass("fc-day-active"),b=d.attr("data-date"),a.hoverDate=b}),$(document).on("mouseout, mouseleave",".fc-week .fc-day",function(b){var c=angular.element(b.currentTarget);c.removeClass("fc-day-active"),a.hoverDate=null})},a.prototype.scrollElementIntoView=function(a){var b=angular.element(a);this.$calendarContent.css({right:b.position().left})},a.prototype.selectDate=function(a){this.selectedDate=a,this.notifyDateSelected(a),this.switchToWeekMode(),this.goToWeekOfSelectedDate(a),this.removePreviousSelectionAndSelect(a)},a.prototype.goToWeekOfSelectedDate=function(a){var b=a.clone().startOf("isoWeek");this.setWeekRange(b)},a.prototype.notifyDateSelected=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.DAY_SELECTED,a)},a.prototype.findElementsByDate=function(a){var b=a.format(this.DateDefaults.DATE_FORMAT);return this.$element.find('[data-date="'+b+'"]')},a.prototype.markSelectedDate=function(b){this.findElementsByDate(b).addClass(a.SELECTED_DAY_CLASS)},a.prototype.removeSelectionMark=function(){this.$element.find("."+a.SELECTED_DAY_CLASS).removeClass(a.SELECTED_DAY_CLASS)},a.prototype.retrieveCalendarProperties=function(){var a=this.$element.find(".fc-week"),b=this.$element.find(".fc-day").first();this.$calendarContent=this.$element.find(".fc-day-grid"),this.calendarSingleWeekWidth=a.width(),this.calendarSingleWeekHeight=a.height(),this.calendarSingleDayWidth=b.outerWidth()},a.prototype.updateCurrentViewRange=function(){var a=this.calendarAPI.getViewDatesRange();this.currentViewRange={start:a.start,end:a.end}},a.prototype.getAvailableSlotsForCurrentRange=function(){return this.getSlotsAvailability({range:this.currentViewRange}).then(this.slotsSrv.getDaysWithAvailableSlots).then(this.calendarAPI.convertDatesToAllDayEvents.bind(this.calendarAPI))},a.prototype.getDaysIntersectionWithPreviousUpperBound=function(){return this.previousViewRange?7*this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.end,this.currentViewRange.start):0},a.prototype.getDaysIntersectionWithPreviousLowerBound=function(){return this.previousViewRange?7*this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.start,this.currentViewRange.end):0},a.prototype.getNumberOfFullWeeksBetweenRanges=function(a,b){var c=a.clone().startOf("day").diff(b,"days");return Math.abs(Math.ceil(c/7))},a.prototype.notifyWeekChanged=function(){this.notifyVisibleDatesRangeChanged(this.currentWeek)},a.prototype.removePreviousSelectionAndSelect=function(a){this.removeSelectionMark(),this.markSelectedDate(a)},a.prototype.onMonthChanged=function(){this.resetViewOffset(),this.notifyMonthChanged(),this.updateCurrentViewRange(),this.updateSlotsAvailability(),this.markPreviouslySelectedDateIfRequired(),this.isInWeeklyMode&&this.calendarAPI.switchToWeekView()},a.prototype.markPreviouslySelectedDateIfRequired=function(){this.selectedDate&&this.selectedDate.isBetween(this.currentViewRange.start,this.currentViewRange.end)&&this.removePreviousSelectionAndSelect(this.selectedDate)},a.prototype.goToTodayInWeekMode=function(){this.setWeekRange(moment().startOf("isoWeek")),this.scrollToWeekOfDay(moment())},a.prototype.updateSlotsAvailability=function(){var a=this;return this.getAvailableSlotsForCurrentRange().then(function(b){a.calendarAPI.addEventsSource(b)})},a.prototype.notifyVisibleDatesRangeChanged=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,a)},a.prototype.notifyLowerBound=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SET_LOWER_BOUND,a)},a.prototype.notifyMonthChanged=function(){var a=this.calendarAPI.getDate(),b={start:a,end:a};this.notifyVisibleDatesRangeChanged(b)},a.prototype.setWeekRange=function(a){void 0===a&&(a=this.currentViewRange.start),this.currentWeek={start:a.clone(),end:a.clone().add(6,"days")},this.notifyWeekChanged()},a.prototype.resetViewOffset=function(){this.retrieveCalendarProperties(),this.$calendarContent.css("right","0px")},a.prototype.goToLastWeekOfMonth=function(){this.$calendarContent.animate({right:"+="+5*this.calendarSingleWeekWidth+"px"})},a.prototype.isNextWeekOutOfCurrentRange=function(){return this.currentWeek.start.isAfter(this.currentViewRange.end.clone().subtract(1,"days"))},a.prototype.goToFirstUnseenDatesOfNextMonth=function(){this.previousViewRange=this.currentViewRange,this.goToNextMonth(),this.animateRight(this.calendarSingleDayWidth*this.getDaysIntersectionWithPreviousUpperBound())},a.prototype.animateRight=function(a){this.$calendarContent.animate({right:"+="+a+"px"})},a.prototype.isPreviousWeekOutOfCurrentRange=function(){return this.currentWeek.end.isBefore(this.currentViewRange.start)},a.prototype.goToFirstUnseenDatesOfPreviousMonth=function(){this.previousViewRange=this.currentViewRange,this.goToPrevMonth(),this.goToLastWeekOfMonth(),this.animateLeft(this.calendarSingleDayWidth*this.getDaysIntersectionWithPreviousLowerBound())},a.prototype.animateLeft=function(a){this.$calendarContent.animate({right:"-="+a+"px"})},a.prototype.refetchEvents=function(b){this.calendarAPI.setTimezone(b),this.calendarAPI.clearEvents(),this.$element.find("[data-date]").removeClass(a.AVAILABLE_DAYS_CLASS),this.updateSlotsAvailability()},a.prototype.registerListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.NEXT_MONTH,this.goToNextMonth),this.$scope.$on(this.CALENDAR_EVENTS.PREV_MONTH,this.goToPrevMonth),this.$scope.$on(this.CALENDAR_EVENTS.COLLAPSE,this.switchToWeekMode),this.$scope.$on(this.CALENDAR_EVENTS.EXPAND,this.switchToMonthMode),this.$scope.$on(this.CALENDAR_EVENTS.NEXT_WEEK,this.goToNextWeek),this.$scope.$on(this.CALENDAR_EVENTS.PREV_WEEK,this.goToPrevWeek),this.$scope.$on(this.CALENDAR_EVENTS.TODAY_REQUESTED,this.goToToday),this.$scope.$on(this.CALENDAR_EVENTS.SELECT_DATE,this.onSelectDate),this.$scope.$on(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,function(b,c){return a.refetchEvents(c)}),this.$scope.$on(this.CALENDAR_EVENTS.GO_TO_MONTH,function(b,c){return a.goToMonth(c)})},a}();b.WEEKLY_MODE_CLASS="calendar--weekly",b.AVAILABLE_DAYS_CLASS="fc-has-event",b.SELECTED_DAY_CLASS="fc-day-selected",a.VisitorCalendarCtrl=b,angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendar",function(){return{templateUrl:"modules/calendar-page/visitor-calendar/visitor-calendar.preload.html",controller:b,controllerAs:"vCldr",bindToController:!0,restrict:"EA",scope:{getSlotsAvailability:"&slotsAvailabilitySource",onReady:"&",timezone:"@"}}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.timezone=b,this.calendarAPI=a.fullCalendar.bind(a)}return a.prototype.goToNextMonth=function(){this.calendarAPI("next")},a.prototype.goToPrevMonth=function(){this.calendarAPI("prev")},a.prototype.goToToday=function(){this.calendarAPI("today")},a.prototype.getViewDatesRange=function(){var a=this.calendarAPI("getView"),b=a.start,c=a.end;return b.tz(this.timezone),c.tz(this.timezone),{start:b,end:c}},a.prototype.getActualDateRange=function(){var a=this.calendarAPI("getView"),b=a.intervalStart,c=a.intervalEnd;return{start:b,end:c}},a.prototype.getDate=function(){return this.calendarAPI("getDate")},a.prototype.addEventsSource=function(a){this.calendarAPI("addEventSource",a)},a.prototype.clearEvents=function(){this.calendarAPI("removeEvents",function(){return!0})},a.prototype.convertDatesToAllDayEvents=function(a){var b=this,c=a.map(function(a){return a=parseInt(a,10),{start:moment.tz(a,b.timezone).format("YYYY-MM-DD"),end:moment.tz(a,b.timezone).format("YYYY-MM-DD"),rendering:"background",allDay:!0}});return c},a.prototype.goToDate=function(a){this.calendarAPI("gotoDate",a)},a.prototype.switchToWeekView=function(){var a=this.calendarAPI("getView"),b=a.coordMap.grid.rowCnt;a.coordMap.grid.colCnt=7*b},a.prototype.switchToMonthView=function(){var a=this.calendarAPI("getView");a.coordMap.grid.colCnt=7},a.prototype.setTimezone=function(a){this.timezone=a},a}();a.FullCalendarAdapter=b,angular.module("schedulerAngularClientAppInternal").service("FullCalendarAdapterFactory",function(){this.create=function(a,c){return new b(a,c)}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){var h=this;this.$rootScope=a,this.CALENDAR_EVENTS=b,this.libs=c,this.timezoneSrv=d,this.visitorBILogger=e,this.$translate=f,this.experimentsEnabler=g,this.isCollapsed=!1,this.onDateRangeChanged=function(a,b){h.visibleDatesRange=b},this.onDaySelected=function(a,b){h.isCollapsed=!0},this.$rootScope.$on(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,this.onDateRangeChanged),this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected),this.$rootScope.$on(this.CALENDAR_EVENTS.SET_LOWER_BOUND,function(a,b){h.lowerBound=b}),this.timezoneSrv.gettingFormattedOffset().then(function(a){h.timeZone=a})}return a.$inject=["$rootScope","CALENDAR_EVENTS","libs","timezoneSrv","visitorBILogger","$translate","experimentsEnabler"],a.prototype.getTitle=function(){return this.visibleDatesRange?this.isCollapsed?this.libs.$.fullCalendar.formatRange(this.visibleDatesRange.start,this.visibleDatesRange.end,this.$translate("visitor.calendar.range-date-format")):this.visibleDatesRange.start.format("MMM. YYYY"):void 0},a.prototype.doCalendarNavigatePrev=function(){this.isCollapsed?this.goToPrevWeek():this.goToPrevMonth()},a.prototype.doCalendarNavigateNext=function(){this.isCollapsed?this.goToNextWeek():this.goToNextMonth()},a.prototype.goToNextMonth=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_MONTH)},a.prototype.goToPrevMonth=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_MONTH)},a.prototype.goToNextWeek=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_WEEK)},a.prototype.goToPrevWeek=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_WEEK)},a.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.TODAY_REQUESTED)},a.prototype.toggleCollapse=function(){this.$rootScope.$broadcast(this.isCollapsed?this.CALENDAR_EVENTS.EXPAND:this.CALENDAR_EVENTS.COLLAPSE),this.isCollapsed=!this.isCollapsed},a.prototype.isRangeBounderyReached=function(){return this.visibleDatesRange.start.isSame(this.lowerBound,"day")},a.prototype.getCollapseStateLabel=function(){return this.isCollapsed?this.$translate("calendar.controls.collapse-switch.label.monthly"):this.$translate("calendar.controls.collapse-switch.label.weekly")},a}();angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendarControls",function(){return{templateUrl:"modules/calendar-page/calendar-controls/visitor-calendar-controls.preload.html",controller:b,transclude:!0,controllerAs:"vccCtrl",bindToController:!0,restrict:"EA"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d,e,f,g,h){var i=this;this.$scope=a,this.$rootScope=b,this.CALENDAR_EVENTS=c,this.$translate=d,this.libs=e,this.timezoneSrv=f,this.experimentsEnabler=g,this.visitorBILogger=h,this.staffListStateMap={},this.onDaySelected=function(){i.selectedSlot=null},this.onSlotSelected=function(a,b){var c=b.getTime().valueOf();i.selectedSlot=i.slots[c]?c:null},this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected),this.$scope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected),this.IS_MULTI_EXPERIMENT_ENABLED=this.experimentsEnabler.isMultipleCalendarsEnabled()}return b.$inject=["$scope","$rootScope","CALENDAR_EVENTS","$translate","libs","timezoneSrv","experimentsEnabler","visitorBILogger"],b.prototype.selectSlot=function(a){this.selectedSlot=+a;var b=this.slots[this.selectedSlot],c=b.length,d=1===c?b[0]:null;this.staffListStateMap=(e={},e[this.selectedSlot]=c>1,e),this.announceSlotSelection(d);var e},b.prototype.selectedStaff=function(a){var b=this.slots[this.selectedSlot].filter(function(b){
return b.id===a})[0];this.visitorBILogger.staffMemberSelectedFromTimeSlot(),this.announceSlotSelection(b)},b.prototype.announceSlotSelection=function(b){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new a.TimeSlotOption(this.selectedSlot,this.timezone,b))},b.prototype.getFormattedDate=function(a){return this.libs.moment.tz(+a,this.timezone).format(this.$translate("visitor.time-format"))},b.prototype.isListEmpty=function(){return!this.slots||0===Object.keys(this.slots).length},b.prototype.getStaff=function(a){return this.slots[a]},b.prototype.staffListClosed=function(){this.staffListStateMap={}},b.prototype.isStaffListOpen=function(a){return this.staffListStateMap[a]},b}();angular.module("schedulerAngularClientAppInternal").directive("boostTimeSlotsList",function(){return{templateUrl:"modules/templates/time-slots-list.preload.html",controller:b,controllerAs:"tslCtrl",scope:{slots:"=",title:"@slotsListTitle",timezone:"@"},bindToController:!0,restrict:"E"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k){var l=this;this.visitorApi=a,this.TimeOfDay=b,this.TimeOfDayBounds=c,this.experimentsEnabler=d,this.momentSrv=e,this.libs=f,this.overEditor=g,this.$q=h,this.servicesSrv=i,this.visitorStaffSrv=j,this.appointmentService=k,this.IS_MULTI_EXPERIMENT_ENABLED=this.experimentsEnabler.isMultipleCalendarsEnabled(),this.visitorStaffSrv.gettingStaffMembers().then(function(a){l.staff=a})}return a.$inject=["visitorApi","TimeOfDay","TimeOfDayBounds","experimentsEnabler","momentSrv","libs","overEditor","$q","servicesSrv","visitorStaffSrv","appointmentService"],a.prototype.getSlotsAvailability=function(a,b,c){var d;if(this.IS_MULTI_EXPERIMENT_ENABLED){if(this.servicesSrv.isDummyService(c)){var e=70;return this.$q.when(this.overEditor.getSlotsAvailability(a,b,this.staff,e))}var f=c.id;d=this.visitorApi.getAvailableSlotsForIndividualService({range:a,timeZone:b,serviceId:f})}else d=this.visitorApi.getSlotsAvailability({range:a,timeZone:b,duration:c.duration});return d.then(function(a){return a.slots})},a.prototype.getDaysWithAvailableSlots=function(a){return Object.keys(a).filter(function(b){return!!a[b].length})},a.prototype.splitFutureSlotsByPartsOfDay=function(a,b){var c=this,d=this.prepareSlotBlocksForTimesOfDay(),e=function(a,b,e){a.forEach(function(a){if(c.isDateInTheFuture(a)){var f=c.determineTimeOfDay(a,b),g=d[f];g[a]=g[a]||[],g[a].push(e)}})};return this.IS_MULTI_EXPERIMENT_ENABLED?a.forEach(function(a){var d=a.slots,f=c.visitorStaffSrv.getStaffListByIds([a.staffId],c.staff)[0];e(d,b,f)}):e(a,b),d},a.prototype.isDateInTheFuture=function(a){var b=moment();return b.isBefore(+a)},a.prototype.prepareSlotBlocksForTimesOfDay=function(){var a=this,b={};return Object.keys(this.TimeOfDay).forEach(function(c){var d=a.TimeOfDay[c];b[d]={}}),b},a.prototype.getDatesWithInstances=function(a,b){var c=[];for(var d in a)if(a[d].length>0){var e=+this.libs.moment.tz(+d,b).startOf("day").format("x");c.push(e)}return c},a.prototype.determineTimeOfDay=function(a,b){var c=this.momentSrv.timestampToMomentInTimezone(a,b).hour();return c<this.TimeOfDayBounds.MORNING?this.TimeOfDay.MORNING:c<this.TimeOfDayBounds.AFTERNOON?this.TimeOfDay.AFTERNOON:this.TimeOfDay.EVENING},a.prototype.getFirstAvailableSlotForIndividualService=function(a,b){var c=this;if(this.servicesSrv.isDummyService(a))return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var d=a.id;return this.getFirstRequiredSlotForIndividual({serviceId:d,timezone:b}).then(function(a){return c.libs.moment(+a.slot)})},a.prototype.getFirstRequiredSlotForIndividual=function(a){var b=this.appointmentService.getCurrentBooking();return b?this.$q.when({slot:b.start}):this.visitorApi.getFirstAvailableSlotForIndividualService(a)},a.prototype.getAvailabilityOfStaffMember=function(a,b){var c={};return Object.keys(a).forEach(function(d){c[d]=a[d].filter(function(a){return a.staffId===b})}),c},a.prototype.createUnifiedSlotsList=function(a){return this.IS_MULTI_EXPERIMENT_ENABLED?this.createUnifiedSlotsListGroupByStart(a):this.createUnifiedSlotsListNoGrouping(a)},a.prototype.getAvailableSlotsForTheDay=function(a,b,c){var d=Object.keys(a).find(function(a){var d=36e5,e=moment.tz(+a,c);return Math.abs(e.diff(b))<=d});return a[d]},a.prototype.partitionSlotsIntoPartsOfDay=function(a,b,c){var d=this.getAvailableSlotsForTheDay(a,b,c);return d?this.splitFutureSlotsByPartsOfDay(d,c):null},a.prototype.createUnifiedSlotsListGroupByStart=function(a){var b=[],c={};return a.forEach(function(a){c[a.start]?c[a.start].slots.push(a):c[a.start]={start:a.start,slots:[a]}}),Object.keys(c).sort().forEach(function(a){b.push(c[a])}),b},a.prototype.createUnifiedSlotsListNoGrouping=function(a){return a.map(function(a){return{start:a.start,slots:[a]}}).sort(function(a,b){return a.start-b.start})},a}();a.SlotsService=b,angular.module("schedulerAngularClientAppInternal").service("slotsSrv",b)}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.MORNING="morning",this.AFTERNOON="afternoon",this.EVENING="evening"}return a}();a.TimeOfDay=b;var c=function(){function a(){this.MORNING=12,this.AFTERNOON=17,this.EVENING=23}return a}();a.TimeOfDayBounds=c;var d=function(){function a(){this.DATE_FORMAT="YYYY-MM-DD"}return a}();a.DateDefaults=d,angular.module("schedulerAngularClientAppInternal").constant("TimeOfDay",new b).constant("TimeOfDayBounds",new c).constant("DateDefaults",new d)}(b=a.constants||(a.constants={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;if(this.$rootScope=a,this.appointmentService=b,this.businessInfoSrv=c,this.$translate=d,this.libs=e,this.CALENDAR_EVENTS=f,this.ServiceTypes=g,this.experimentsEnabler=h,this.$filter=i,this.participantsVisibility=!0,this.onSlotSelected=function(a,b){j.staffMember=b.getStaff(),j.selectedTime=j.selectedDate=b.getTime()},this.onDateSelected=function(a,b){j.selectedTime=null,j.selectedDate=j.libs.moment(b),j.staffMember=null},!angular.isNumber(this.numOfStaff))throw new Error("numOfStaff must me a number");this.service=b.getSelectedService(),c.gettingBusinessInfo().then(function(a){j.businessInfo=a,j.addressKey=a.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt"}),this.checkForPreviouslySelectedSlot(),this.setupListeners()}return a.$inject=["$rootScope","appointmentService","businessInfoSrv","$translate","libs","CALENDAR_EVENTS","ServiceTypes","experimentsEnabler","$filter"],a.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a},a.prototype.setupListeners=function(){var b=this;this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDateSelected),this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected),this.$rootScope.$on(a.EVENTS.SERVICE_UPDATED,function(a,c){return b.onServiceUpdated(c)})},a.prototype.checkForPreviouslySelectedSlot=function(){var a=this.appointmentService.getSelectedTime();a&&(this.selectedDate=this.createMomentFromTime(+a.startTime),this.selectedTime=this.createMomentFromTime(+a.startTime),this.staffMember=a.staffMember)},a.prototype.createMomentFromTime=function(a){return this.timezone?this.libs.moment.tz(a,this.timezone):this.libs.moment(a)},a.prototype.getTitle=function(){return this.service.name},a.prototype.getDuration=function(){return this.service.duration},a.prototype.getDate=function(){return this.selectedDate.format(this.$translate("sidebar.date-format"))},a.prototype.getTime=function(){return this.selectedTime?this.selectedTime.format(this.$translate("visitor.time-format")):""},a.prototype.isShowSlotInfo=function(){return!(!this.selectedDate&&!this.selectedTime)},a.prototype.getBusinessName=function(){return this.businessInfo.name},a.prototype.getBusinessCity=function(){return this.appointmentService.getBusinessCity(this.businessInfo)},a.prototype.getLocation=function(){return this.appointmentService.getAppointmentLocation()},a.prototype.getLocationText=function(){return this.appointmentService.getAppointmentLocationText()},a.prototype.getCancellationPolicy=function(){return this.businessInfo.cancellationPolicy},a.prototype.getTeacher=function(){return this.staffMember&&this.numOfStaff>1?this.staffMember.fullName:""},a.prototype.getMinCharge=function(){return this.service.minCharge},a.prototype.getSelectedNumberOfParticipants=function(){return this.service.numberOfParticipants||1},a.prototype.getCurrency=function(){return this.service.currency},a.prototype.onServiceUpdated=function(a){this.service=Object.assign({},a)},a}();b.EVENTS={SERVICE_UPDATED:"Sidebar.SERVICE_UPDATED"},a.VisitorSidebar=b,angular.module("schedulerAngularClientAppInternal").directive("boostVisitorSidebar",function(){return{templateUrl:"modules/sidebar/sidebar.preload.html",controller:b,controllerAs:"sbCtrl",bindToController:!0,restrict:"EA",scope:{isLastStep:"=",actionLabel:"@",isActionEnabled:"=actionEnabled",onActionClick:"&actionClick",timezone:"@",sidebarShowUpfront:"@",numOfStaff:"="}}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.visitorBILogger=a,this.isCollapsed=!0}return a.$inject=["visitorBILogger"],a.prototype.toggleCollapse=function(){this.visitorBILogger.cancellationPolicy(),this.isCollapsed=!this.isCollapsed},a}();a.CollapsableSidebarWidget=b,angular.module("schedulerAngularClientAppInternal").directive("boostCollapsableWidget",function(){return{templateUrl:"modules/templates/collapsable-sidebar-widget.preload.html",controller:b,controllerAs:"cswCtrl",scope:{title:"@",content:"@"},bindToController:!0,restrict:"EA"}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(a){a[a.SUCCESS=1e5]="SUCCESS",a[a.PAYPAL_BLOCKED=-100001]="PAYPAL_BLOCKED",a[a.PAYPAL_CANCELLED=-100002]="PAYPAL_CANCELLED"}(c=b.PaypalStatus||(b.PaypalStatus={}));var d;!function(a){a[a.STRIPE_CANCELLED=-200002]="STRIPE_CANCELLED"}(d=b.StripeStatus||(b.StripeStatus={}));var e=function(){function a(){this.PAYPAL_KEY="paypal",this.STRIPE_KEY="stripe",this.PAYMENT_TYPE_ONLINE="ONLINE",this.PAYMENT_TYPE_OFFLINE="OFFLINE",this.PAYMENT_TYPE_ALL="ALL"}return a}();b.PaymentType=e;var f=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l,m){this.$q=a,this.modal=b,this.appointmentService=c,this.commonServices=d,this.$window=e,this.visitorBILogger=f,this.$interval=g,this.$translate=h,this.wixSdkUtil=i,this.experimentsEnabler=j,this.visitorApi=k,this.stripeAdapter=l,this.PAYPAL_KEY=m.PAYPAL_KEY,this.STRIPE_KEY=m.STRIPE_KEY,this.PAYMENT_TYPE_ONLINE=m.PAYMENT_TYPE_ONLINE,this.PAYMENT_TYPE_OFFLINE=m.PAYMENT_TYPE_OFFLINE,this.PAYMENT_TYPE_ALL=m.PAYMENT_TYPE_ALL}return b.$inject=["$q","modal","appointmentService","commonServices","$window","visitorBILogger","$interval","$translate","wixSdkUtil","experimentsEnabler","visitorApi","stripeAdapter","paymentType"],b.prototype.initPaymentsForService=function(a){return void 0===a&&(a=this.appointmentService.getSelectedService()),this.isStripePaymentAllowed(a)?this.stripeAdapter.initStripeDetails(a):this.$q.when()},b.prototype.handle=function(){var a=this;return this.initAvailablePaymentTypes().then(function(b){return a.handlePaymentOption(b)})},b.prototype.isPaypalOnly=function(){return this.isOnlinePaymentType()&&this.isPayPalPaymentEnabled()&&!this.isStripePaymentEnabled()},b.prototype.isStripeOnly=function(){return this.isOnlinePaymentType()&&!this.isPayPalPaymentEnabled()&&this.isStripePaymentEnabled()},b.prototype.setBusinessInfo=function(a){this.businessInfo=a},b.prototype.isOnlinePaymentAllowed=function(){return this.isPaymentNeeded(this.appointmentService.getSelectedService())&&(this.isPayPalPaymentEnabled()||this.isStripePaymentEnabled())},b.prototype.isOfflinePaymentAllowed=function(a){return void 0===a&&(a=this.appointmentService.getSelectedService()),this.isPaymentType(this.PAYMENT_TYPE_OFFLINE,a)||this.isPaymentType(this.PAYMENT_TYPE_ALL,a)},b.prototype.isPaymentNeeded=function(a){return void 0===a&&(a=this.appointmentService.getSelectedService()),!a.isFree&&!this.isPaymentType(this.PAYMENT_TYPE_OFFLINE,a)&&!a.dummy},b.prototype.isStripePaymentAllowed=function(a){return this.isStripePaymentEnabled()&&!this.isPaymentType(this.PAYMENT_TYPE_OFFLINE,a)&&this.isPaymentNeeded(a)},b.prototype.gettingPaypalUrlForSelectedService=function(){return this.visitorApi.gettingPaypalUrlForService(this.appointmentService.getSelectedService())},b.prototype.isPayPalPaymentEnabled=function(){return this.isPaymentSourceEnabled("isPaypalConnected")},b.prototype.isStripePaymentEnabled=function(){return this.experimentsEnabler.isStripePaymentEnabled()&&this.isPaymentSourceEnabled("isStripeConnected")},b.prototype.isPaymentSourceEnabled=function(a){return this.businessInfo&&this.businessInfo.payments&&this.businessInfo.payments[a]},b.prototype.initAvailablePaymentTypes=function(){return this.isOnlinePaymentAllowed()?this.selectPaymentOption():this.$q.when(this.PAYMENT_TYPE_OFFLINE)},b.prototype.selectPaymentOption=function(){return this.isMultiplePaymentTypes()?this.$q.when(this.openPaymentSelectionDialog()):this.$q.when(this.getDefaultPaymentOption())},b.prototype.getDefaultPaymentOption=function(){return this.isOnlinePaymentType()?this.isStripePaymentEnabled()?this.STRIPE_KEY:this.PAYPAL_KEY:this.PAYMENT_TYPE_OFFLINE},b.prototype.openPaymentSelectionDialog=function(){var a=this;return this.wixSdkUtil.resetHeight(),this.modal.openDetails({templateUrl:"modules/templates/payment-options-modal.preload.html",controller:"SelectPaymentOptionController",controllerAs:"paymentCtrl",windowClass:"modal--payment-options",resolve:{businessInfo:function(){return a.businessInfo}}}).result},b.prototype.isMultiplePaymentTypes=function(a){return this.isPaymentType(this.PAYMENT_TYPE_ALL,a)||this.isStripePaymentEnabled()&&this.isPayPalPaymentEnabled()},b.prototype.isOnlinePaymentType=function(a){return this.isPaymentType(this.PAYMENT_TYPE_ONLINE,a)},b.prototype.isPaymentType=function(a,b){return void 0===b&&(b=this.appointmentService.getSelectedService()),b.paymentType===a},b.prototype.handlePaymentOption=function(a){return a===this.PAYPAL_KEY?this.openPaypalUrl():a===this.STRIPE_KEY?this.handleStripePaymentOption():(this.appointmentService.setPaymentInfo({paymentType:this.PAYMENT_TYPE_OFFLINE}),this.$q.when())},b.prototype.handleStripePaymentOption=function(){var a=this;return this.stripeAdapter.usingStripeForService().then(function(b){return a.appointmentService.setPaymentInfo({paymentType:a.PAYMENT_TYPE_ONLINE,paymentDetails:{stripe:b}}),b})},b.prototype.openPaypalUrl=function(){var b=this;this.removeCallbackInformation(),this.$window.wixBoostVisitorPaymentConfirm=function(a,c){b.paypalData.payerId=a,b.paypalData.token=c},this.visitorBILogger.paypalWindoOpen();var c=this.$window.open("","_blank");return c?(this.$window.focus&&c.focus(),this.populatePopupWithPaypalUrl(c).then(function(a){return b.waitForPopupToCloseAndHandleResponse(a)})):this.$q.reject(a.boost.visitor.payments.PaypalStatus.PAYPAL_BLOCKED)},b.prototype.populatePopupWithPaypalUrl=function(a){return a.document.write(this.$translate("visitor.confirmation.payment-options.redirecting")),this.gettingPaypalUrlForSelectedService().then(function(b){return a.location.href=b.url,a})},b.prototype.waitForPopupToCloseAndHandleResponse=function(a){var b=this,c=this.$q.defer(),d=this.$interval(function(){a.closed?(b.resolvePerCallbackValue(c),angular.isDefined(d)&&b.$interval.cancel(d)):b.isPaypalCallbackDataPopulated()&&a.close()},300);return c.promise},b.prototype.resolvePerCallbackValue=function(a){if(this.isPaypalCallbackDataPopulated()){var b=this.getPaypalCallbackData();this.removeCallbackInformation(),this.paypalPaymentConfirmedCallback(a,b)}else this.paypalPaymentCancelledCallback(a)},b.prototype.paypalPaymentConfirmedCallback=function(a,b){this.sendPayapalRedirectResponseBi(!0),this.appointmentService.setPaymentInfo({paymentType:this.PAYMENT_TYPE_ONLINE,paymentDetails:{paypal:b}}),a.resolve(b)},b.prototype.paypalPaymentCancelledCallback=function(b){this.sendPayapalRedirectResponseBi(!1),b.reject(a.boost.visitor.payments.PaypalStatus.PAYPAL_CANCELLED)},b.prototype.isPaypalCallbackDataPopulated=function(){return this.paypalData.payerId&&this.paypalData.token},b.prototype.removeCallbackInformation=function(){this.paypalData={}},b.prototype.sendPayapalRedirectResponseBi=function(a){var b=this.appointmentService.getSelectedService();this.visitorBILogger.sendPaymentProcessOutcome({success:a,price:this.commonServices.decorateServicePriceForBi(b),depositAmount:this.commonServices.decorateServiceMinChargeForBi(b),currency:b.currency})},b.prototype.getPaypalCallbackData=function(){return this.paypalData},b}();b.PaymentService=f,angular.module("schedulerAngularClientAppInternal").constant("paymentType",new e).service("paymentService",f)}(c=b.payments||(b.payments={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ServiceClassicWithImage=function(){function a(){this.hover=!1}return a.prototype.isShowOverlay=function(){return!(this.isImageRound&&!this.description)},a.prototype.isHideImage=function(){return this.isImageRound&&this.hover&&this.isShowOverlay()},Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithImage",{templateUrl:"modules/service-tile/heidi/classic-with-image.preload.html",controller:ServiceClassicWithImage,bindings:{imageUrl:"@",isImageRound:"=",onClick:"&",service:"=",serviceDays:"=",buttonText:"@"}});var ServiceClassicWithoutImage=function(){function a(){}return Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithoutImage",{templateUrl:"modules/service-tile/heidi/classic-without-image.preload.html",controller:ServiceClassicWithoutImage,bindings:{onClick:"&",service:"=",serviceDays:"=",buttonText:"@"}});var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b.call(this,m,n,p,o,q)||this;return u.$scope=c,u.flowManagerSrv=d,u.routeManager=e,u.clientPages=f,u.TILE_LIST_EVENTS=g,u.ServiceTypes=h,u.overEditor=i,u.visitorBILogger=j,u.activeFeatures=k,u.features=l,u.appSettings=q,u.IS_ONBOARDING=r,u.$rootScope=s,u.$filter=t,u.groupSelectedButNotPremium=!1,u.updateGroupsPerCategory=function(a){u.groups=u.updatePerCategory(a,u.groupsList.classes)},u.groupsList=a.current.locals.groupList,u.serviceList=a.current.locals.serviceList,u.groups=u.groupsList.classes,u.categories=u.groupsList.categories,u.$scope.$on(g.TILE_SELECTED,function(a,b){u.next(b)}),o.updateModelClasses(u.groupsList),u.individualServices=a.current.locals.serviceList,u.isShowIndividualServiceButton=u.showIndividualServiceButton(),u.isNoServicesOverEditor=i.isOverEditor&&u.groups.length&&u.groups[0].dummy,u.categoriesType=q.getGroupsCategoryLayoutType(u.categories.length),u}return __extends(c,b),c.$inject=["$route","$scope","flowManagerSrv","routeManager","clientPages","TILE_LIST_EVENTS","ServiceTypes","overEditor","visitorBILogger","activeFeatures","features","groupsSrv","servicesSrv","commonServices","SERVICE_CATEGORY_LAYOUT","appSettings","IS_ONBOARDING","$rootScope","$filter"],c.prototype.isPageTitleShown=function(){return!!this.$filter("wixSdkTranslate")("groups-list.title","textPageTitleGroups")},c.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},c.prototype.showIndividualServiceButton=function(){return this.hasIndividualServices()?!0:this.hasIndividualServices()||this.hasGroupsServices()?void 0:!0},c.prototype.goToIndividual=function(){this.visitorBILogger.switchServiceType(this.ServiceTypes.INDIVIDUAL),this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},c.prototype.next=function(b){this.flowManagerSrv.initiateGroup(b),this.visitorBILogger.bookIt(),this.isGroupSelectionAllowed()?this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR):(this.groupSelectedButNotPremium=!0,this.visitorBILogger.bookedGroupButNotPremium(),this.groupsSrv.notifyingNonPremiumEnrollmentAttempt(),this.$rootScope.$broadcast(a.boost.visitor.directives.ScrollToMe.SCROLL_EVENT,{toElement:"appMessage"}))},c.prototype.isGroupSelectionAllowed=function(){return this.activeFeatures[this.features.GROUPS]||this.overEditor.isDemoFlow},c}(BaseServicesCtrl);b.GroupListPage=c,angular.module("schedulerGroupAppInternal").directive("boostGroupListPage",function(){return{templateUrl:"modules/group-list/group-list-page.preload.html",controller:c,controllerAs:"groupListPage",bindToController:!0,restrict:"E"}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k){this.visitorApi=a,this.$translate=b,this.libs=c,this.boostInjectionPersister=d,this.$q=e,this.overEditor=f,this.visitorStaffSrv=g,this.experimentsEnabler=h,this.$timeout=i,this.businessInfoSrv=j,this.appointmentService=k}return a.$inject=["visitorApi","$translate","libs","boostInjectionPersister","$q","overEditor","visitorStaffSrv","experimentsEnabler","$timeout","businessInfoSrv","appointmentService"],a.prototype.gettingGroupsList=function(){var a=this;return this.gettingRealGroups().then(function(b){return a.hasGroups(b)?b:a.overEditor.enrichGroupListIfOverEditor(b)})},a.prototype.hasRealGroups=function(a){return this.hasGroups(a)&&!a.classes[0].dummy},a.prototype.notifyingNonPremiumEnrollmentAttempt=function(){return this.visitorApi.notifyingNonPremiumEnrollmentAttempt()},a.prototype.gettingGroupsInstances=function(a,b){var c=this;if(this.isOnDemoMode(a))return this.$q.when(this.$timeout(function(){return c.visitorStaffSrv.gettingStaffMembers().then(function(a){return c.overEditor.getClassesInstancesIfOverEditor(b,a)})}));var d=this.createRangeWithTimeZoneCompensation(b);return this.visitorApi.gettingGroupsInstances({id:a,dateRange:d}).then(function(a){return c.filterClassInstanceByDatRange(a,b)})},a.prototype.gettingFutureGroupInstances=function(a,b){var c=this.libs.moment().valueOf();return this.gettingGroupsInstances(a,b).then(function(a){return a.classesInstances=a.classesInstances.filter(function(a){return a.start>c}),a})},a.prototype.isOnDemoMode=function(a){return!a},a.prototype.createRangeWithTimeZoneCompensation=function(a){return{start:a.start.clone().subtract(1,"days"),end:a.end.clone().add(1,"days")}},a.prototype.filterClassInstanceByDatRange=function(a,b){var c=Object.assign({},a);return c.classesInstances=a.classesInstances.filter(function(a){return moment(a.start).isBetween(b.start,b.end,null,"[)")}),c},a.prototype.hasGroups=function(a){return a&&a.classes&&a.classes.length>0},a.prototype.gettingRealGroups=function(){var a=this.boostInjectionPersister.getGroupsList();return a?this.$q.when(a):this.visitorApi.gettingGroups()},a.prototype.getTranslatedActiveDays=function(a){var b=[];for(var c in a.classHours)if(a.classHours[c]){var d=a.classHours[c];if(d.workingHours&&d.workingHours.length>0){var e=this.$translate("week-day."+c);-1===b.indexOf(e)&&b.push(e)}}return b},a.prototype.convertInstancesToAvailableTimeSlots=function(a,b,c){for(var d,e=["mon","tue","wed","thu","fri","sat","sun"],f={},g=0;g<e.length;g++)f[e[g]]=[];for(var h=this.visitorStaffSrv.createId2StaffMemberMap(c),i=this.groupInstancesByTime(a),g=0;g<i.length;g++){d=this.libs.moment.tz(i[g][0].start,b).isoWeekday()-1;var j=i[g],k=this.createGroupInstancesTimeSlot(j,h);f[e[d]].push(k)}return this.sortTimeSlots(e,f),f},a.prototype.createGroupInstancesTimeSlot=function(a,b){return{instances:a,availableStaff:this.visitorStaffSrv.getStaffListByStaffMap(a.map(function(a){return a.staffMemberId}),b),staffStatus:a.reduce(function(a,b){return a.set(b.staffMemberId,{isFull:b.capacity<=b.registered}),a},new Map)}},a.prototype.sortTimeSlots=function(a,b){for(var c=0;c<a.length;c++)b[a[c]].sort(function(a,b){var c=a.instances[0],d=b.instances[0];return c.start-d.start})},a.prototype.getDatesWithInstances=function(a,b){var c=this,d=[];return a.forEach(function(a){var e=+c.libs.moment.tz(a.start,b).startOf("day").format("x");-1===d.indexOf(e)&&d.push(e)}),d},a.prototype.getFutureInstancesWithVacancyOnGivenDay=function(a,b){var c=this,d=this.libs.moment();return a.filter(function(a){var e=moment(a.start);return b.isSame(e,"day")&&e.isAfter(d)&&c.isInstanceAvailable(a)})},a.prototype.getInstanceById=function(a,b){return a.filter(function(a){return a.id===b})[0]},a.prototype.isInstanceAvailable=function(a){return a.registered<a.capacity},a.prototype.getFirstAvailableSlotForPrototype=function(a){var b=this;if(!a||!a.id||a.dummy)return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var c=a.id;return this.$q.all([this.businessInfoSrv.gettingBusinessInfo(),this.getFirstRequiredSlotForGroup({groupProtoId:c})]).then(function(a){var c=a[0],d=a[1];return b.libs.moment.tz(+d.slot,c.timeZone)})},a.prototype.getFirstRequiredSlotForGroup=function(a){var b=this.appointmentService.getCurrentBooking();return b?this.$q.when({slot:b.start}):this.visitorApi.getFirstAvailableSlotForGroupPrototype(a)},a.prototype.groupInstancesByTime=function(a){var b=[];if(this.experimentsEnabler.isMultipleCalendarsEnabled()){var c={};a.forEach(function(a){c[a.start]||(c[a.start]=[]),c[a.start].push(a)}),Object.keys(c).forEach(function(a){b.push(c[a])})}else a.forEach(function(a){b.push([a])});return b},a}();a.GroupsService=b,angular.module("schedulerGroupAppInternal").service("groupsSrv",b)}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.groupsSrv=b,this.activeDays=b.getTranslatedActiveDays(this.group)}return a.$inject=["appSettings","groupsSrv"],a}();angular.module("schedulerAngularClientAppInternal").component("boostGroupTile",{template:'<boost-service-tile service="$ctrl.group" size="{{$ctrl.size}}" template="{{$ctrl.template}}" service-days="$ctrl.activeDays" config="$ctrl.tileConfig" button-text="{{\'group-select-button\' | wixSdkTranslate: \'textBookButtonGroups\'}}" custom-class="group" style="width:100%;"></boost-service-tile>',controller:b,bindings:{group:"=",size:"@",template:"@",tileConfig:"=config"}})}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.libs=a,this.$translate=b,this.experimentsEnabler=c,this.groupsSrv=d,this.appointmentService=e,this.DateDefaults=g,this.$scope=h,this.$rootScope=i,this.CALENDAR_EVENTS=j,this.visitorBILogger=k,this.visitorStaffSrv=l,this.$filter=m,this.flowManagerSrv=n,this.isActionComplete=!1,this.pickerOpened=!1,this.selectedService=e.getSelectedService(),this.businessInfo=f.current.locals.businessInfo;var o=f.current.locals.firstAvailableDate;this.staff=f.current.locals.staff,this.IS_MULTI_EXPERIMENT_ON=c.isMultipleCalendarsEnabled(),this.populateValidStaffMembers(),this.updateSelectedWeekPerSelectedDate(o),this.registerEventListeners()}return a.$inject=["libs","$translate","experimentsEnabler","groupsSrv","appointmentService","$route","DateDefaults","$scope","$rootScope","CALENDAR_EVENTS","visitorBILogger","visitorStaffSrv","$filter","flowManagerSrv"],a.prototype.populateValidStaffMembers=function(){this.availableStaffMembers=this.visitorStaffSrv.getCapableStaffByStaff(this.staff).map(function(a){return{value:a.id,label:a.fullName}}),this.availableStaffMembers=this.$filter(OrderByLowerCase.FILTER_NAME)(this.availableStaffMembers,"label")},a.prototype.updateSelectedWeekPerSelectedDate=function(a){var b=this;this.splitInstances={};var c=a.clone().startOf("isoWeek"),d=a.clone().endOf("isoWeek");this.currentWeek={start:c,end:d};var e=this.selectedService.dummy?null:this.selectedService.id;this.groupsSrv.gettingFutureGroupInstances(e,this.currentWeek).then(function(a){b.classInstances=a.classesInstances,b.updateInstancesModel()})},a.prototype.updateInstancesModel=function(){var a=this,b=this.selectedStaffMemberId?this.classInstances.filter(function(b){return b.staffMemberId===a.selectedStaffMemberId}):this.classInstances;this.splitInstances=this.groupsSrv.convertInstancesToAvailableTimeSlots(b,this.businessInfo.timeZone,this.staff),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED)},a.prototype.getFormattedDateRange=function(){return this.libs.$.fullCalendar.formatRange(this.currentWeek.start,this.currentWeek.end,this.$translate("visitor.calendar.range-date-format"))},a.prototype.goToNextWeek=function(){this.promoteWeekByAmount(1)},a.prototype.goToPrevWeek=function(){this.promoteWeekByAmount(-1)},a.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.updateSelectedWeekPerSelectedDate(this.libs.moment.tz(this.businessInfo.timeZone))},a.prototype.goBack=function(){this.flowManagerSrv.prev()},a.prototype.goToNextPage=function(){this.visitorBILogger.sendNext("date&time"),this.flowManagerSrv.next()},a.prototype.getDayByIndex=function(a){return this.currentWeek.start.clone().add(a,"day").format(this.DateDefaults.DATE_FORMAT)},a.prototype.triggerDatePicker=function(a){this.pickerOpened?this.pickerOpened=!1:(a.preventDefault(),a.stopPropagation(),this.pickerOpened=!0)},a.prototype.disabled=function(a,b){var c=new Date;return"day"===b&&c>a},a.prototype.onStaffMemberFilterSelected=function(a){this.selectedStaffMemberId!==a&&(this.selectedStaffMemberId=a,this.updateInstancesModel())},a.prototype.promoteWeekByAmount=function(a){var b=this.currentWeek.start.clone().add(a,"week");this.updateSelectedWeekPerSelectedDate(b)},a.prototype.registerEventListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.visitorBILogger.selectSlot(),a.IS_MULTI_EXPERIMENT_ON?a.isActionComplete=!!c.getStaff():a.isActionComplete=!0}),this.$scope.$watch(function(){return a.selectedDate},function(b){b&&(a.pickerOpened=!1,a.updateSelectedWeekPerSelectedDate(a.libs.moment(b)))})},Object.defineProperty(a.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),a}();a.GroupsCalendar=b,angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendar",function(){return{templateUrl:"modules/visitor/groups/groups-calendar.preload.html",controller:b,controllerAs:"groupsCalendar",bindToController:!0,restrict:"E"}})}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.calendar.TimeSlotOption,d=function(){function a(a,b,c,d,e,f,g,h,i){this.appointmentService=a,this.libs=b,this.CALENDAR_EVENTS=c,this.$rootScope=e,this.DateDefaults=f,this.groupsSrv=g,this.$timeout=h,this.experimentsEnabler=i,this.todayDate=new Date,
this.selectedService=a.getSelectedService(),this.timeFormat=d("visitor.time-format"),this.registerDateSelectionChanges(),this.initialize()}return a.$inject=["appointmentService","libs","CALENDAR_EVENTS","$translate","$rootScope","DateDefaults","groupsSrv","$timeout","experimentsEnabler"],a.prototype.initialize=function(){this.isRepresentingToday=this.libs.moment().tz(this.calendarDayTimezone).format(this.DateDefaults.DATE_FORMAT)===this.calendarDay,this.calendarDayMoment=this.libs.moment.tz(this.calendarDay,this.calendarDayTimezone)},a.prototype.hasSlotsThisDay=function(){return this.calendarDayList&&this.calendarDayList.length>0},a.prototype.isSingleGroupFull=function(a){var b=this,c=!0;return a.instances.forEach(function(a){c=c&&!b.groupsSrv.isInstanceAvailable(a)}),c},a.prototype.isInstancePassedDue=function(a){return a.instances[0].start<this.todayDate.getTime()},a.prototype.isSingleGroupUnavailable=function(a){return this.isSingleGroupFull(a)||this.isInstancePassedDue(a)},a.prototype.getSingleGroupLabel=function(a){return this.libs.moment.tz(a.instances[0].start,this.calendarDayTimezone).format(this.timeFormat)},a.prototype.closeGroupInstanceTooltip=function(a){a.isOpen=!1},a.prototype.slotSelected=function(a){var b=this;this.isSingleGroupUnavailable(a)||(this.selectedInstance=a,a.instances.length>1?(this.$timeout(function(){b.selectedInstance.isOpen=!0}),this.deselectPrevSlot(),this.notifySlotSelected(a.instances[0],null)):this.selectGroupInstance(a.instances[0]))},a.prototype.deselectPrevSlot=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_DESELECTED)},a.prototype.isGroupSlotSelected=function(a){return a===this.selectedInstance},a.prototype.selectStaffMemberInSlot=function(a){var b=this;this.selectedInstance.instances.forEach(function(c){c.staffMemberId===a&&b.selectGroupInstance(c)})},a.prototype.getDayNumber=function(){return this.calendarDayMoment.day()},a.prototype.selectGroupInstance=function(a){var b=this.experimentsEnabler.isMultipleCalendarsEnabled()?this.getStaffById(a.staffMemberId):{fullName:a.teacher,id:null},c={startTime:""+a.start,endTime:""+a.end,timeZone:this.calendarDayTimezone,staffMember:b,groupInstance:a};this.appointmentService.setSelectedTime(c),this.notifySlotSelected(a,b)},a.prototype.notifySlotSelected=function(a,b){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new c(a.start,this.calendarDayTimezone,b))},a.prototype.getStaffById=function(a){return this.staff.staff.filter(function(b){return b.id===a})[0]},a.prototype.registerDateSelectionChanges=function(){var a=this;this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.calendarDay!==c.getTime().format(a.DateDefaults.DATE_FORMAT)&&(a.selectedInstance=void 0)}),this.$rootScope.$on(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED,function(){a.initialize()})},a}();angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendarDay",function(){return{templateUrl:"modules/visitor/groups/groups-calendar-day.preload.html",controller:d,controllerAs:"groupsCalendarDay",bindToController:!0,restrict:"E",scope:{calendarDay:"=",calendarDayList:"=",calendarDayTimezone:"=",staff:"="}}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=b.call(this,a,c,d,e,f,g,h,i,j,k,l,m)||this;return p.$rootScope=n,p.experimentsEnabler=o,p.attendeesAmountOptions=p.generateAttendeesAmountOptions(),p.priceForSingleParticipant=p.selectedService.price,p.updateGroupWithQuantity(1),p}return __extends(c,b),c.$inject=["routeManager","clientPages","$route","appointmentService","servicesSrv","wixSdkUtil","wixBiLogger","commonServices","paymentService","visitorBILogger","$scope","userManagementSrv","$rootScope","experimentsEnabler"],c.prototype.generateAttendeesAmountOptions=function(){return this.allowedNumberOfParticipants=Math.min(this.selectedService.maxParticipantsPerOrder,this.selectedTime.groupInstance.capacity-this.selectedTime.groupInstance.registered)||0,Array.from(Array(this.allowedNumberOfParticipants).keys()).map(function(a){return a++,{label:""+a,value:a}})},c.prototype.doBack=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},c.prototype.goToFlowEnd=function(){this.routeManager.gotoPage(this.clientPages.GROUPS_VISITOR_CONGRATS)},c.prototype.getTimezone=function(){return this.businessInfo.timeZone},c.prototype.onAttendeesAmountChanged=function(a){this.persistNewQuantity(a),this.notifyQuantityUpdated()},c.prototype.isMaxParticipantsSelectionNeeded=function(){return this.isMultipleParticipantsAllowed()&&this.allowedNumberOfParticipants>1},c.prototype.isMultipleParticipantsAllowed=function(){return this.experimentsEnabler.isAdditionalParticipantsEnabled()},c.prototype.notifyQuantityUpdated=function(){this.initPaymentsForService(),this.$rootScope.$broadcast(a.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,this.selectedService)},c.prototype.updateGroupWithQuantity=function(a){Object.assign(this.selectedService,{numberOfParticipants:a,price:this.totalPrice(a)})},c.prototype.totalPrice=function(a){return this.priceForSingleParticipant*a},c.prototype.persistNewQuantity=function(a){this.updateGroupWithQuantity(a),this.visitorBILogger.logParticipantsAmountChanged(a)},c}(a.boost.visitor.pages.ContactInfoController);b.GroupsContactInfoController=c,angular.module("schedulerAngularClientAppInternal").controller("GroupsContactInfoCtrl",c)}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){var h=this;this.showTimezoneNote=!1,a.all([c.gettingBusinessInfo(),b.gettingUserTimezone()]).then(function(a){var b=a[0].timeZone,c=a[1];if(c!==b){var i="business"===g.boostTimezoneNote?b:c,j=d.timestampToLocaleMoment(e.moment().format("x"),i).format("Z");h.formattedMessage=f("calendar.displayed-time-timezone-formatted",{offset:j}),h.showTimezoneNote=!0}else h.formattedMessage="",h.showTimezoneNote=!1})}return a.$inject=["$q","timezoneSrv","businessInfoSrv","momentSrv","libs","$translate","$attrs"],a}();angular.module("schedulerAngularClientAppInternal").directive("boostTimezoneNote",function(){return{template:'<div class="timezone-note" data-hook="timezone-note" ng-if="timezoneNoteCtrl.showTimezoneNote">{{timezoneNoteCtrl.formattedMessage}}</div>',controller:b,controllerAs:"timezoneNoteCtrl",bindToController:!0,restrict:"A"}})}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.routeManager=a,this.$route=b,this.postLoginNavigationSrv=c,this.serviceTypeNavigationSrv=d,this.widgetDeepLinkNavigationSrv=e,this.registerNavigationServices(),this.redirect()}return a.$inject=["routeManager","$route","postLoginNavigationSrv","serviceTypeNavigationSrv","widgetDeepLinkNavigationSrv"],a.prototype.registerNavigationServices=function(){this.serviceTypeNavigationSrv.init(this.$route.current.locals.servicesList,this.$route.current.locals.groupsList),this.navigationServices=[this.postLoginNavigationSrv,this.widgetDeepLinkNavigationSrv,this.serviceTypeNavigationSrv]},a.prototype.redirect=function(){this.routeManager.suspendFocus=!0;for(var a=0;a<this.navigationServices.length;a++){var b=this.navigationServices[a];if(b.isRedirectRequired()){b.doRedirect();break}}},a}();a.ServiceTypePage=b,angular.module("schedulerAngularClientAppInternal").component("boostServiceTypePage",{template:"",controller:b,controllerAs:"vm"})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$scope=a}return a.$inject=["$scope"],Object.defineProperty(a.prototype,"address",{get:function(){return this.resolveServiceAddress()},enumerable:!0,configurable:!0}),a.prototype.resolveServiceAddress=function(){return this.isServiceGivenRemotely()?this.serviceLocationText:this.isServiceGivenAtBusinessLocation()?this.isRemoteBusiness()?this.businessName:this.businessAddress:this.isServiceGivenAtCustomerPlace()?this.serviceLocationText:void 0},a.prototype.isRemoteBusiness=function(){return"ON_THE_GO"===this.businessLocation},a.prototype.isServiceGivenAtBusinessLocation=function(){return"BUSINESS"===this.serviceLocation},a.prototype.isServiceGivenRemotely=function(){return"OTHER"===this.serviceLocation},a.prototype.isServiceGivenAtCustomerPlace=function(){return"CUSTOMER"===this.serviceLocation},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceAddress",{template:"{{$ctrl.address}}",controller:b,bindings:{serviceLocationText:"@sLocText",serviceLocation:"@sLoc",businessLocation:"@bLoc",businessName:"@bName",businessAddress:"@bAddr"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Timezones=wix.boost.common.constants.Timezones,VisitorBiListenerSrv=function(a){function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,e)||this;return k.appointmentService=c,k.commonServices=d,k.timezoneSrv=f,k.businessInfoSrv=g,k.$q=h,k.routeManager=i,k.userManagementSrv=j,k}return __extends(b,a),b.$inject=["wixBiLogger","appointmentService","commonServices","$rootScope","timezoneSrv","businessInfoSrv","$q","routeManager","userManagementSrv"],b.prototype.init=function(){var a=this;this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS,function(){return a.saveSuccessContactInfo()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED,function(){return a.appointmentCreated()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.PAYMENT_METHOD_MODAL_OPENED,function(b,c){return a.openPaymentSelectionModal(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY,function(){return a.cancellationPolicy()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT,function(){return a.selectSlot()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER,function(){return a.bookAnother()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT,function(){return a.googleCalendar()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.BOOKIT,function(){return a.bookIt()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM,function(){return a.bookedGroupButNotPremium()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CAL_TODAY,function(){return a.todayClick()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.NEXT,function(b,c){return a.sendNext(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,function(b,c){return a.selectServiceType(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.SWITCH_SERVICE_TYPE,function(b,c){return a.switchServiceType(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CAL_MOVE,function(){return a.monthChangeClick()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.PAYPAL_REDIRECT_DONE,function(b,c){return a.sendPaymentProcessOutcome(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.PAYMENT_METHOD_SELECTED_MODAL,function(b,c){return a.paymentMethodSelected(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,function(b,c){return a.servicesPageOpened(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.PAYPAL_WINDOW_OPENED,function(){return a.paypalPageOpened()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED,function(){return a.staffMemberPopupOpenedFromTimeSlot()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER,function(){return a.staffMemberSelectedFromTimeSlot()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION,function(){return a.staffMemberSelectionChangedFromCalendar()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE,function(){return a.logTimezone()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,function(b,c){return a.logParticipantsAmountChanged(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,function(b,c){return a.popupClosed(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,function(b,c){return a.timezoneSwitched(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED,function(){return a.timezonePopupOpened()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,function(b,c){return a.logDeepLinkCalendarOpened(c)}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED,function(){return a.logLoginClicked()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT,function(){return a.logGoToAccountManagement()}),this.$rootScope.$on(wix.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,function(b,c){return a.logLoginComplete(c)})},b.prototype.todayClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_TODAY,{})},b.prototype.bookIt=function(){var a=this.getServiceId();this.logWithServiceType(this.wixBiLogger.events.BOOKIT,{service_id:a,logged:this.userManagementSrv.isLoggedIn()})},b.prototype.googleCalendar=function(){this.logWithServiceType(this.wixBiLogger.events.GOOGLE_EXPORT,{})},b.prototype.bookAnother=function(){this.logWithServiceType(this.wixBiLogger.events.BOOK_ANOTHER,{})},b.prototype.selectSlot=function(){this.logWithServiceType(this.wixBiLogger.events.CHOOSE_TIME_SLOT,{})},b.prototype.cancellationPolicy=function(){this.logWithServiceType(this.wixBiLogger.events.CANCELLATION_POLICY,{})},b.prototype.openPaymentSelectionModal=function(a){this.logWithServiceType(this.wixBiLogger.events.PAYMENT_METHOD_MODAL_OPENED,Object.assign({},this.getAppointmentDetailsForBi({messageEmptyNeeded:!1,paymentInfo:!1}),{options:JSON.stringify(a)}))},b.prototype.appointmentCreated=function(){var a=this.userManagementSrv.isLoggedIn();this.logWithServiceType(this.wixBiLogger.events.APPOINTMENT_BOOKED,Object.assign({logged:a},this.getAppointmentDetailsForBi({messageEmptyNeeded:!1,paymentInfo:!0})))},b.prototype.saveSuccessContactInfo=function(){this.logWithServiceType(this.wixBiLogger.events.CONTACT_INFO_SAVE_SUCCESS,this.getAppointmentDetailsForBi())},b.prototype.bookedGroupButNotPremium=function(){this.wixBiLogger.log(this.wixBiLogger.events.BOOKED_GROUP_BUT_NOT_PREMUIM)},b.prototype.paypalPageOpened=function(){this.wixBiLogger.log(this.wixBiLogger.events.PAYPAL_WINDOW_OPENED)},b.prototype.sendNext=function(a){var b=this.getSelectedService();this.logWithServiceType(this.wixBiLogger.events.NEXT,{price_selection:this.getFreeLabel(b),referal_info:a,price:this.commonServices.decorateServicePriceForBi(b),depositAmount:this.commonServices.decorateServiceMinChargeForBi(b),currency:b.currency,categoryId:b.categoryId,serviceId:b.id})},b.prototype.selectServiceType=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SERVICE_TYPE_WELCOME_PAGE,{type:a})},b.prototype.switchServiceType=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SWITCH_SERVICE_TYPE,{switchToType:a})},b.prototype.monthChangeClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_MOVE,{})},b.prototype.sendPaymentProcessOutcome=function(a){var b=this.getServiceId();a.serviceId=b,this.logWithServiceType(this.wixBiLogger.events.PAYPAL_REDIRECT_DONE,a)},b.prototype.paymentMethodSelected=function(a){var b=this.getServiceId();this.logWithServiceType(this.wixBiLogger.events.PAYMENT_METHOD_SELECTED_MODAL,{selection:a,serviceId:b})},b.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},b.prototype.staffMemberSelectedFromTimeSlot=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER)},b.prototype.staffMemberSelectionChangedFromCalendar=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHANGE_STAFF_MEMBER_SELECTION)},b.prototype.logParticipantsAmountChanged=function(a){this.wixBiLogger.log(this.wixBiLogger.events.PARTICIPANTS_AMOUNT_CHANGE,{numParticipants:a})},b.prototype.getFreeLabel=function(a){return a&&a.isFree?"price_free":"price_paid"},b.prototype.getAppointmentDetailsForBi=function(a){var b=this;void 0===a&&(a={messageEmptyNeeded:!0,paymentInfo:!1});var c=this.getSelectedService(),d=this.getPaymentInfo(),e=this.getContactInfo(),f={categoryId:c.categoryId,currency:c.currency,price:this.commonServices.decorateServicePriceForBi(c),price_selection:this.getFreeLabel(c),serviceId:c.id,type:c.type,numParticipants:c.numberOfParticipants||1};return a.messageEmptyNeeded&&(f.message_empty=function(){return b.isEmpatyString(e)}),a.paymentInfo&&(f.paymentMethod=d.paymentType),f},b.prototype.getServiceId=function(){return this.getSelectedService().id},b.prototype.getServiceType=function(){return this.getSelectedService().type},b.prototype.getSelectedService=function(){return this.appointmentService.getSelectedService()||{}},b.prototype.getPaymentInfo=function(){return this.appointmentService.getPaymentInfo()||{}},b.prototype.getContactInfo=function(){return this.appointmentService.getContactInfo()||{}},b.prototype.logWithServiceType=function(a,b){b.type=this.getServiceType(),this.wixBiLogger.log(a,b)},b.prototype.servicesPageOpened=function(a){var b={type:a};this.wixBiLogger.log(this.wixBiLogger.events.SERVICES_PAGE_OPENED,b)},b.prototype.logTimezone=function(){var a=this;this.$q.all([this.timezoneSrv.gettingFormattedOffset(),this.timezoneSrv.gettingUserTimezone(),this.businessInfoSrv.gettingBusinessInfo()]).then(function(b){var c={ownerTimeZone:b[2].timeZone,ownerOffset:b[2].timeZoneOffset,visitorTimeZone:b[1],visitorOffset:b[0]};a.wixBiLogger.log(a.wixBiLogger.events.LOG_TIMEZONE,c)})},b.prototype.popupClosed=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SYS_MSG_CLOSE,{referal_info:a})},b.prototype.timezoneSwitched=function(a){var b=a===Timezones.BUSINESS?"business time zone":"local";this.wixBiLogger.log(this.wixBiLogger.events.TIMEZONE_SWITCH,{changeTo:b})},b.prototype.timezonePopupOpened=function(){this.wixBiLogger.log(this.wixBiLogger.events.TIMEZONE_POPUP_OPENED)},b.prototype.logDeepLinkCalendarOpened=function(a){this.wixBiLogger.log(this.wixBiLogger.events.DEEP_LINK_CALENDAR_OPEN,a)},b.prototype.logLoginClicked=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.LOGIN_CLICKED,a)},b.prototype.logLoginComplete=function(a){var b={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.LOGIN_COMPLETE,Object.assign(b,a))},b.prototype.logGoToAccountManagement=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.GO_TO_ACCOUNT_MANAGEMENT,a)},b}(BILogger);angular.module("schedulerAngularClientAppInternal").service("visitorBiListener",VisitorBiListenerSrv);var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.tileTemplate=b.getGroupListTemplate(),d.tileConfig=b.getGroupsTileConfig(),d.columnsAmount=b.getNumberOfColumns(d.tileTemplate,b.getGroupsCategoryLayoutType()),d.serviceItemClass=d.mapColumnsAmountToClass(),d}return __extends(b,a),b.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],b}(a.ServicesList);angular.module("schedulerAngularClientAppInternal").component("boostGroupsList",{templateUrl:"modules/groups/components/groups-list.preload.html",bindings:{groups:"="},controller:c})}(b=a.classes||(a.classes={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$scope=a}return a.$inject=["$scope"],a.prototype.selectTab=function(a){this.onTabSelectedCallback({value:a.value})},a.prototype.isSelected=function(a){return this.selectedValue===a.value},a}();b.SELECTED_CLASS="tab--selected",a.TabsController=b,angular.module("schedulerAngularClientAppInternal").component("boostTabs",{template:'<div class="tab" ng-repeat="item in $ctrl.list | orderBy:\'order\':$ctrl.descending track by $index" data-hook="tab" data-tab-value="{{item.value}}" ng-click="$ctrl.selectTab(item)" ng-class="{\'tab--selected\': $ctrl.isSelected(item)}">{{item.defaultTextKey | wixSdkTranslate: item.settingsTextKey}}</div>',controller:b,bindings:{list:"=",onTabSelectedCallback:"&onTabSelected",selectedValue:"=",descending:"="}})}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.routeManager=a,this.visitorBILogger=b,this.clientPages=c,this.ServiceTypes=d,this.TABS_ORDER=e,this.tabs=[{order:1,value:d.INDIVIDUAL,defaultTextKey:"visitor.service-types.services",settingsTextKey:"textTitleIndividualService"},{order:2,value:d.GROUP,defaultTextKey:"visitor.service-types.groups",settingsTextKey:"textTitleGroupService"}]}return a.$inject=["routeManager","visitorBILogger","clientPages","ServiceTypes","TABS_ORDER"],a.prototype.onTabSelected=function(a){if(a!==this.current){var b=a===this.ServiceTypes.INDIVIDUAL;this.visitorBILogger.switchServiceType(b?this.ServiceTypes.INDIVIDUAL:this.ServiceTypes.GROUP),this.routeManager.suspendFocus=!0,this.routeManager.gotoPage(b?this.clientPages.VISITOR_SERVICES:this.clientPages.VISITOR_GROUPS)}},a.prototype.isInDescendingOrder=function(){return this.firstServiceType!==this.TABS_ORDER.INDIVIDUAL_FIRST},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceTypeTabs",{templateUrl:"modules/common/components/service-type-tabs/service-type-tabs.preload.html",controller:b,bindings:{current:"@",firstServiceType:"="}})}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var UpfrontPaymentController=function(){function a(a,b,c,d,e){this.experimentsEnabler=a,this.$filter=b,this.$translate=c,this.paymentService=d,this.$scope=e,this.init()}return a.$inject=["experimentsEnabler","$filter","$translate","paymentService","$scope"],a.prototype.init=function(){var a=this;this.quantity=angular.isDefined(this.quantity)?this.quantity:1,this.isUpfrontPaymentPresent=!!(this.minCharge&&this.experimentsEnabler.isUpfrontPaymentEnabled()&&this.paymentService.isOnlinePaymentAllowed()),this.isUpfrontPaymentPresent&&(this.populateDisplayText(),this.$scope.$watch(function(){return a.quantity},function(){return a.populateDisplayText()})),this.notifyVisibilityChangeIfRequired()},a.prototype.populateDisplayText=function(){var a=this.minCharge*this.quantity,b=this.$filter("isoCurrency")(a,this.currency),c=this.isConfirmation?"visitor.congratulations.upfront-payment-text":"sidebar.upfront-payment-text-secondary";this.displayText=this.$translate(c,{minCharge:b})},a.prototype.notifyVisibilityChangeIfRequired=function(){this.onVisibilityChange&&this.onVisibilityChange({value:this.isUpfrontPaymentPresent})},a.prototype.getText=function(){return this.displayText},a}();angular.module("schedulerAngularClientAppInternal").component("boostUpfrontPayment",{templateUrl:"modules/common/directives/upfront-payment.preload.html",controller:UpfrontPaymentController,controllerAs:"upCtrl",restrict:"AE",bindings:{minCharge:"=",currency:"=",isConfirmation:"=",quantity:"=?",onVisibilityChange:"&"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){angular.module("schedulerAngularClientAppInternal").component("boostVisitorContactInfoPage",{templateUrl:"modules/desktop/contact-info-form/old-templates/new-visitor-contact-info-page.preload.html",controller:"ContactInfoCtrl",controllerAs:"contactInfoCtrl",restrict:"E"})}(b=a.pages||(a.pages={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){angular.module("schedulerAngularClientAppInternal").component("boostGroupsVisitorContactInfoPage",{templateUrl:"modules/desktop/contact-info-form/old-templates/groups-contact-info-page.preload.html",controller:"GroupsContactInfoCtrl",controllerAs:"contactInfoCtrl"})}(b=a.pages||(a.pages={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ContactInfoSrv=function(){function a(a,b,c){this.appointmentService=a,this.userManagementSrv=b,this.servicesSrv=c,this.selectedService=this.initObj(this.appointmentService.getSelectedService())}return a.$inject=["appointmentService","userManagementSrv","servicesSrv"],a.prototype.getContactInfo=function(){return this.initObj(this.appointmentService.getContactInfo())},a.prototype.getLoggedInUser=function(){return this.initObj(this.userManagementSrv.getCurrentSiteMember())},a.prototype.isAddressNeeded=function(){return this.servicesSrv.requireAddress(this.selectedService)},a.prototype.getMaxParticipants=function(){var a=this.initObj(this.appointmentService.getSelectedTime());return Math.min(this.selectedService.maxParticipantsPerOrder,a.groupInstance.capacity-a.groupInstance.registered)},a.prototype.initObj=function(a){return a?a:{}},a}();angular.module("schedulerAngularClientAppInternal").service("contactInfoSrv",ContactInfoSrv);var ContactInfoFormComponent=function(){function a(){}return a.prototype.showLoggedUserDetails=function(){return this.showLoggedUserEmail()},a.prototype.showLoggedUserName=function(){return this.loggedInUser.fullName},a.prototype.showLoggedUserEmail=function(){return this.loggedInUser.email},a.prototype.showLoggedUserPhone=function(){return this.loggedInUser.phoneNumber},a.prototype.showAddressContainer=function(){return this.viewParams.hasAddress},a.prototype.showMaxParticipantsDropdown=function(){return this.viewParams.maxParticipants&&this.viewParams.maxParticipants>1},a}();angular.module("schedulerAngularClientAppInternal").component("bksContactInfoForm",{templateUrl:"modules/desktop/contact-info-form/contact-info-form.preload.html",controller:ContactInfoFormComponent,bindings:{contactInfo:"=",loggedInUser:"=",viewParams:"="}});var StaffPickerComponent=function(){function a(a,b){this.$scope=a,this.visitorBILogger=b,this.staffStatus=this.staffStatus||new Map,this.resetSelectedIndexIfDataSourceChanges(),this.visitorBILogger.staffMemberPopupOpenedFromTimeSlot()}return a.$inject=["$scope","visitorBILogger"],a.prototype.selectStaffMember=function(a,b){if(!this.isFull(b)){this.selectedStaffIndex=a;var c=b.id;this.onStaffSelected({staffMemberId:c})}},a.prototype.isFull=function(a){var b=this.staffStatus.get(a.id);return b&&b.isFull},a.prototype.resetSelectedIndexIfDataSourceChanges=function(){var a=this;this.$scope.$watch(function(){return a.staff},function(){a.selectedStaffIndex=-1})},a}();angular.module("schedulerAngularClientAppInternal").component("boostStaffPicker",{templateUrl:"modules/components/staff-picker.preload.html",controller:StaffPickerComponent,bindings:{staff:"=",staffStatus:"=?",onStaffSelected:"&"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.$onInit=function(){this.items=this.itemsInput.slice(),this.setDefaultAndNotify()},a.prototype.setDefaultAndNotify=function(){var a=!this.defaultOptionLabel&&!this.selectedItem&&this.items.length;this.initDefaultOption(),!this.selectedItem&&this.items.length&&(this.selectedItem=this.items[0]),a&&this.onSelect(this.selectedItem)},a.prototype.initDefaultOption=function(){if(this.defaultOptionLabel){var a={value:"",label:this.defaultOptionLabel};this.items.unshift(a)}},a.prototype.onSelect=function(a){this.selectedItem=a,this.onSelectCallback({value:a.value})},a.prototype.onToggle=function(a){this.isOpen=a,this.onToggleCallBack({open:a})},a}();a.Dropdown=b,angular.module("schedulerAngularClientAppInternal").component("boostDropdown",{template:'\n        <div class="dropdown" ng-class="$ctrl.customClass" dropdown dropdown-append-to-body on-toggle="$ctrl.onToggle(open)" data-hook="dropdown">\n            <div class="button btn btn-default dropdown__button" ng-class="{\'dropdown__button--open\': $ctrl.isOpen}" dropdown-toggle ng-disabled="disabled" type="button" data-hook="dropdown_button">\n              <span class="dropdown__label" data-hook="dropdown-select-label" data-value="{{$ctrl.selectedItem.value}}">{{$ctrl.selectedItem.label}}</span>\n              <span class="dropdown__caret scheduler-svg-font-icons-groups-calendar-week-prev"></span>\n            </div>\n            <ul class="dropdown-menu">\n              <div data-hook="dropdown-menu-content" class="dropdown-menu__content" boost-scrollbar="{{$ctrl.scrollbarType || \'dark-3\'}}"  boost-scrollbar-amount="25" boost-scrollbar-inertia="600">\n                <li class="dropdown-menu__item" ng-repeat="item in $ctrl.items" data-hook="dropdown-item" data-value="{{item.value}}" ng-click="$ctrl.onSelect(item)">{{item.label}}</li>\n              </div>\n            </ul>\n        </div>\n         ',controller:b,bindings:{itemsInput:"=items",onSelectCallback:"&onSelect",defaultOptionLabel:"@",onToggleCallBack:"&onToggle",scrollbarType:"@?",customClass:"@",selectedItem:"=?"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var VisitorStaffSrv=function(){function a(a,b,c,d,e,f,g){this.visitorApi=a,this.experimentsEnabler=b,this.appointmentService=c,this.$q=d,this.boostInjectionPersister=e,this.overEditor=f,this.ServiceTypes=g}return a.$inject=["visitorApi","experimentsEnabler","appointmentService","$q","boostInjectionPersister","overEditor","ServiceTypes"],a.prototype.gettingStaffMembers=function(){var a=this;return this.gettingRealStaffMembers().then(function(b){return a.overEditor.enrichStaffIfOverEditor(b),b})},a.prototype.gettingRealStaffMembers=function(){if(this.experimentsEnabler.isMultipleCalendarsEnabled()){var a=this.boostInjectionPersister.getStaff();return a?this.$q.when(a):this.visitorApi.gettingStaffMembers()}return this.$q.when({staff:[]})},a.prototype.getStaffListByIds=function(a,b){var c=[];return a&&b.staff&&b.staff.length&&(c=this.getStaffListByStaffMap(a,this.createId2StaffMemberMap(b))),c},a.prototype.createId2StaffMemberMap=function(a){var b={};return a.staff.forEach(function(a){b[a.id]=a}),b},a.prototype.getStaffListByStaffMap=function(a,b){var c=[];return a.forEach(function(a){c.push(b[a])}),c},a.prototype.getCapableStaff=function(){var a=this;return this.gettingStaffMembers().then(function(b){return a.getCapableStaffByStaff(b)})},a.prototype.getCapableStaffByStaff=function(a){var b,c=this.appointmentService.getSelectedService();return b=c?c.dummy?a.staff.map(function(a){return a.id}):this.getValidStaffIdsForService(c):[],this.getStaffListByIds(b,a)},a.prototype.getValidStaffIdsForService=function(a){return a.type===this.ServiceTypes.GROUP?this.getStaffIdsForGroup(a):this.getStaffIdsForIndividualService(a);
},a.prototype.getStaffIdsForGroup=function(a){for(var b=["mon","tue","wed","thu","fri","sat","sun"],c={},d=0;d<b.length;d++)a.classHours&&a.classHours[b[d]]&&a.classHours[b[d]].workingHours.forEach(function(a){a.staffId&&(c[a.staffId]=!0)});return Object.keys(c)},a.prototype.getStaffIdsForIndividualService=function(a){return a.staffMembers||[]},a}();angular.module("schedulerAngularClientAppInternal").service("visitorStaffSrv",VisitorStaffSrv),function(){function a(a){var b=a.$parent.$parent.$parent,c=b.staff,d=b.staffStatus,e=b.onStaffSelected;a.staff=c,a.staffStatus=d,a.onStaffSelected=function(a){return e({staffMemberId:a})}}function b(){return{restrict:"EA",replace:!0,controller:a,controllerAs:"staffPickerTooltipPopupCtrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:'<div class="staff-member-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="staff-member-popover">\n         <div class="popover-inner" boost-scrollbar="default" boost-scrollbar-amount="25" boost-scrollbar-inertia="600" ><boost-staff-picker staff="staff" on-staff-selected="onStaffSelected(staffMemberId)" staff-status="staffStatus"></boost-staff-picker></div>\n         </div>'}}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").directive("boostStaffPickerTooltipPopup",b).directive("boostStaffPickerTooltip",["$tooltip","$timeout",function(a,b){var c=a("boostStaffPickerTooltip","boostStaffPickerTooltip","staff-member-selection.open");c.scope={staff:"=",staffStatus:"=?",onStaffSelected:"&",onTooltipClose:"&",staffMemberSelectionOpen:"="};var d=c.compile();return{restrict:"A",scope:c.scope,link:function(a,c,e){function f(d,e){void 0===e&&(e=!1),b(function(){c.trigger(d),e&&a.onTooltipClose()})}function g(){i.off("click",g),f("staff-member-selection.close",!0)}function h(){i.click(g)}d.call(null,a,c,e);var i=angular.element("body");a.$watch("staffMemberSelectionOpen",function(a){angular.isDefined(a)&&(a?(f("staff-member-selection.open"),b(h)):g())})}}}])}();var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.pages.CongratulationsController,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=a.call(this,b,c,d,e,f,g,h,i,j,k,l,m)||this;return n.messageKeys={translate:"visitor.congratulations.message",settings:"textCongrads"},n.instructionsKeys={translate:"visitor.congratulations.instructions",settings:"textCongradsNotes"},n.googleKeys={translate:"visitor.groups.congratulations.export",settings:"textCongradsGoogle"},n.bookAnotherKeys={translate:"visitor.congratulations.bookanother",settings:"textCongradsBookAnother"},n.bookAnotherPage=n.clientPages.VISITOR_SERVICES,n.type="individual",n}return __extends(b,a),b.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","libs","visitorBILogger","$route","cacheSrv","paymentType","experimentsEnabler"],b}(c);b.IndividualCongratulationsController=d,angular.module("schedulerAngularClientAppInternal").controller("IndividualCongratulationsController",d),angular.module("schedulerAngularClientAppInternal").component("boostIndividualCongratulationsPage",{templateUrl:["appConfig",function(a){return c.getTemplateUrl(a.getIsMobile())}],controller:d})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.pages.CongratulationsController,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=a.call(this,b,c,d,e,f,g,h,i,j,l,m,k)||this;return n.messageKeys={translate:"visitor.groups.congratulations.message",settings:"textCongradsGroups"},n.instructionsKeys={translate:"visitor.groups.congratulations.instructions",settings:"textCongradsNotesGroups"},n.googleKeys={translate:"visitor.groups.congratulations.export",settings:"textCongradsGoogleGroups"},n.bookAnotherKeys={translate:"visitor.groups.congratulations.bookanother",settings:"textCongradsBookAnotherGroups"},n.bookAnotherPage=n.clientPages.VISITOR_GROUPS,n.participantsVisibility=!0,n.type="groups",n}return __extends(b,a),b.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","libs","visitorBILogger","$route","experimentsEnabler","cacheSrv","paymentType"],b.prototype.isMultipleParticipants=function(){return this.serviceInfo.numberOfParticipants&&this.isMoreThanOneRoomsLeft()&&this.experimentsEnabler.isAdditionalParticipantsEnabled()},b.prototype.isMoreThanOneRoomsLeft=function(){return this.appointmentTime.groupInstance.capacity-this.appointmentTime.groupInstance.registered>1},b}(c);b.GroupCongratulationsController=d,angular.module("schedulerAngularClientAppInternal").controller("GroupCongratulationsController",d),angular.module("schedulerAngularClientAppInternal").component("boostGroupCongratulationsPage",{templateUrl:["appConfig",function(a){return c.getTemplateUrl(a.getIsMobile())}],controller:d})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var OrderByLowerCase=function(){function a(){}return a.prototype.filter=function(b,c){return b.sort(function(b,d){return a.sortByStringNoCase(b[c],d[c])})},a.sortByStringNoCase=function(a,b){var c=a?a.toLowerCase():"",d=b?b.toLowerCase():"";return c>d?1:d>c?-1:0},a}();OrderByLowerCase.FILTER_NAME="boostOrderByLowerCase",angular.module("schedulerAngularClientAppInternal").filter(OrderByLowerCase.FILTER_NAME,function(){return(new OrderByLowerCase).filter});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.currentTime=a,this.originalFrom=b,this.originalTo=c}return Object.defineProperty(a.prototype,"fromPosition",{get:function(){return Math.max(this.originalFrom,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"toPosition",{get:function(){return Math.max(this.originalTo,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nextPosition",{get:function(){var b=a.DEFAULT_DURATION,c=this.calculateDelta(this.toPosition,this.fromPosition),d=this.calculateProgress(this.currentTime,b);return this.calculatePosition(c,d)},enumerable:!0,configurable:!0}),a.prototype.calculateProgress=function(a,b){return a/b*(Math.PI/2)},a.prototype.calculatePosition=function(a,b){return a*Math.sin(b)},a.prototype.calculateDelta=function(a,b){return a-b},a}();b.DEFAULT_DURATION=300,a.SmoothScroll=b;var c=function(){function a(b,c,d,e,f){this.$timeout=c,this.$wix=d,this.$element=e,this.$attrs=f,this.offset=0,b.$on(a.SCROLL_EVENT,this.scroll.bind(this))}return a.$inject=["$scope","$timeout","$wix","$element","$attrs"],a.prototype.scroll=function(a,b){"number"==typeof b.offset&&(this.offset=b.offset),b.toElement===this.$attrs.boostScrollToMe&&this.$wix.getBoundingRectAndOffsets(this.calculateAndScroll.bind(this))},a.prototype.calculateAndScroll=function(b){this.scrollToMyself(this.calculateCurrentPagePosition(b),this.calculateToPosition(b),a.DEFAULT_CURRENT_TIME)},a.prototype.scrollToMyself=function(a,c,d){var e=b.DEFAULT_DURATION;if(!this.isScrollingComplete(d,e)){var f=new b(d,a,c);this.requestScrolling(f.fromPosition,f.nextPosition),this.scheduleNextScroll(f.fromPosition,f.toPosition,f.currentTime)}},a.prototype.isScrollingComplete=function(a,b){return a>=b},a.prototype.scheduleNextScroll=function(b,c,d){var e=this,f=d+a.DEFAULT_INTERVAL;this.$timeout(function(){return e.scrollToMyself(b,c,f)},a.DEFAULT_INTERVAL)},a.prototype.calculateToPosition=function(a){return a.offsets.y+this.$element.offset().top-this.offset},a.prototype.calculateCurrentPagePosition=function(a){return a.offsets.y-a.rect.top},a.prototype.requestScrolling=function(a,b){this.$wix.scrollTo(0,a+b)},a}();c.SCROLL_EVENT="SCROLL_EVENT",c.DEFAULT_INTERVAL=10,c.DEFAULT_CURRENT_TIME=0,a.ScrollToMe=c,angular.module("schedulerAngularClientCommon").directive("boostScrollToMe",function(){return{restrict:"A",controller:c,controllerAs:"$crtl",bindToController:!0}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var WidgetRouteController=function(){function a(a,b,c,d,e){this.$route=a,this.routeManager=b,this.clientPages=c,this.flowManagerSrv=d,this.visitorBILogger=e,this.init(),this.goToService()}return a.$inject=["$route","routeManager","clientPages","flowManagerSrv","visitorBILogger"],a.prototype.goToService=function(){"individual"===this.serviceType?this.individualService():"group"===this.serviceType&&this.groupService()},a.prototype.individualService=function(){var a=this.getIndividual();this.sendBiEvent(),a?this.goToIndividual(a):this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a.prototype.groupService=function(){var a=this.getGroupService();this.sendBiEvent(),a?this.goToGroup(a):this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a.prototype.sendBiEvent=function(){this.visitorBILogger.logDeepLinkCalendarOpened({referralInfo:"widget",service_id:this.serviceId,type:this.serviceType})},a.prototype.init=function(){this.groupsList=this.$route.current.locals.groupsList,this.serviceList=this.$route.current.locals.servicesList,this.serviceId=this.$route.current.params.serviceId,this.serviceType=this.$route.current.serviceType},a.prototype.getIndividual=function(){return this.getService(this.serviceList.services)},a.prototype.getGroupService=function(){return this.getService(this.groupsList.classes)},a.prototype.getService=function(a){var b=this,c=a.filter(function(a){return a.id===b.serviceId});return c.length>0?c[0]:null},a.prototype.goToIndividual=function(a){this.setIndividualService(a),this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},a.prototype.setIndividualService=function(a){this.flowManagerSrv.initiateIndividual(a)},a.prototype.goToGroup=function(a){this.setGroupService(a),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},a.prototype.setGroupService=function(a){this.flowManagerSrv.initiateGroup(a)},a}();angular.module("schedulerAngularClientAppInternal").component("boostWidgetRoute",{template:"",controller:WidgetRouteController});var ParticipantsSummaryComponent=function(){function a(a,b,c,d){var e=this;this.experimentsEnabler=c,this.selectedService=a.getSelectedService(),this.selectedTime=a.getSelectedTime(),this.notifyVisibilityChangeIfRequired(),d.getIsMobile()||b.$on(wix.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,function(a,b){e.selectedService=b})}return a.$inject=["appointmentService","$rootScope","experimentsEnabler","appConfig"],a.prototype.isNumberOfParticipantsRequired=function(){return this.isMaxParticipantsOverOne()&&this.isOverOneRoomsLeft()&&this.experimentsEnabler.isAdditionalParticipantsEnabled()},a.prototype.isMaxParticipantsOverOne=function(){return this.selectedService.maxParticipantsPerOrder>1},a.prototype.isOverOneRoomsLeft=function(){return this.selectedTime&&this.selectedTime.groupInstance?this.selectedTime.groupInstance.capacity-this.selectedTime.groupInstance.registered>1:!1},a.prototype.getTranslateParams=function(){return{numberOfParticipants:this.selectedService.numberOfParticipants||1}},a.prototype.notifyVisibilityChangeIfRequired=function(){this.onVisibilityChanged&&this.onVisibilityChanged({value:this.isNumberOfParticipantsRequired()})},a}();angular.module("schedulerAngularClientAppInternal").component("boostParticipantsSummary",{template:'<div data-hook="participants-summary-container" ng-if="$ctrl.isNumberOfParticipantsRequired()">{{\'participants-summary.participants\' | translate:$ctrl.getTranslateParams()}}</div>',controller:ParticipantsSummaryComponent,bindings:{onVisibilityChanged:"&"}});var StripeAdapterSrv=function(){function a(a,b){this.visitorApi=a,this.$q=b}return a.$inject=["visitorApi","$q"],a.prototype.initStripeDetails=function(a){var b=this;return this.visitorApi.gettingStripeDetailsForService(a).then(function(a){return b.stripeDetails=a,a})},a.prototype.usingStripeForService=function(){var a,b=this.$q.defer();return this.initHandler(),this.handler.open({name:this.stripeDetails.name,description:this.stripeDetails.description,amount:this.stripeDetails.amount,currency:this.stripeDetails.currency,token:function(c){a={source:c.id,chargeId:c.card?c.card.id:null},b.resolve(a)},closed:function(){a?b.resolve(a):b.reject(wix.boost.visitor.payments.StripeStatus.STRIPE_CANCELLED)}}),b.promise},a.prototype.initHandler=function(){this.handler||(this.handler=StripeCheckout.configure({key:this.stripeDetails.key,locale:"auto"}))},a}();angular.module("schedulerAngularClientAppInternal").service("stripeAdapter",StripeAdapterSrv);var WixPageNavigation=function(){function a(a,b,c,d){this.$wix=a,this.clientPages=b,this.routeManager=c,this.$rootScope=d}return a.$inject=["$wix","clientPages","routeManager","$rootScope"],a.prototype.init=function(){var a=this;this.$wix.getCurrentPageId(function(b){a.pageId=b,a.setListener()})},a.prototype.setListener=function(){var a=this;this.$wix.addEventListener(this.$wix.Events.PAGE_NAVIGATION_IN,function(b){b.toPage===a.pageId&&a.routeFromStorageData()})},a.prototype.routeFromStorageData=function(){var a=this;this.$rootScope.$applyAsync(function(){a.routeManager.gotoPage(a.clientPages.VISITOR_SPLASH)})},a}();angular.module("schedulerAngularClientAppInternal").service("wixPageNavigation",WixPageNavigation);var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.userManagementSrv=a}return a.$inject=["userManagementSrv"],a.prototype.isRedirectRequired=function(){return!!this.userManagementSrv.getPreviousPageInfo()},a.prototype.doRedirect=function(){this.userManagementSrv.restoreLoginState()},a}();a.PostLoginNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("postLoginNavigationSrv",b)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.routeManager=a,this.clientPages=b,this.appSettings=c,this.visitorBILogger=d,this.servicesSrv=e,this.groupsSrv=f,this.TABS_ORDER=g,this.firstServiceType=c.getServiceOrderWithoutDefault()}return a.$inject=["routeManager","clientPages","appSettings","visitorBILogger","servicesSrv","groupsSrv","TABS_ORDER"],a.prototype.isRedirectRequired=function(){return!0},a.prototype.doRedirect=function(){this.hasBothServiceOrNoServices()&&this.isUserPreferencesDefined()?this.redirectPerUserPreferences():this.redirectPerUserServices()},a.prototype.init=function(a,b){this.servicesList=a,this.groupsList=b},a.prototype.hasBothServiceOrNoServices=function(){return this.hasBothServices()||this.hasNoServices()},a.prototype.hasBothServices=function(){return this.hasIndividual()&&this.hasGroups()},a.prototype.hasNoServices=function(){return!this.hasIndividual()&&!this.hasGroups()},a.prototype.isUserPreferencesDefined=function(){return this.firstServiceType},a.prototype.redirectPerUserServices=function(){this.shouldShowIndividualOnly()?this.goToIndividual():this.goToGroups()},a.prototype.redirectPerUserPreferences=function(){this.firstServiceType===this.TABS_ORDER.INDIVIDUAL_FIRST?this.goToIndividual():this.goToGroups()},a.prototype.shouldShowIndividualOnly=function(){return this.hasIndividual()||!this.hasGroups()},a.prototype.hasGroups=function(){return this.groupsSrv.hasRealGroups(this.groupsList)},a.prototype.hasIndividual=function(){return this.servicesSrv.hasRealServices(this.servicesList)},a.prototype.goToIndividual=function(){this.visitorBILogger.servicesPageOpened("private"),this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},a.prototype.goToGroups=function(){this.visitorBILogger.servicesPageOpened("group"),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS)},a}();a.ServiceTypeNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("serviceTypeNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.routeManager=a,this.clientPages=b,this.$cookies=c}return a.$inject=["routeManager","clientPages","$cookies"],a.prototype.isRedirectRequired=function(){return this.hasDeepLinkingData()},a.prototype.doRedirect=function(){this.redirectPerDeepLinkingData()},a.prototype.redirectPerDeepLinkingData=function(){var a=this.$cookies.get("serviceType"),b=this.$cookies.get("serviceId"),c="group"===a?this.clientPages.WIDGET_GROUP:this.clientPages.WIDGET_INDIVIDUAL;this.cleanDeepLinkCookies(),this.routeManager.gotoPage(c+"/"+b)},a.prototype.hasDeepLinkingData=function(){return"true"===this.$cookies.get("deepLink")},a.prototype.cleanDeepLinkCookies=function(){this.$cookies.put("deepLink","false")},a}();a.WidgetDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("widgetDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.clientPagesConst=new ClientPages,b.PERSONAL_INFO=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,b.PACKAGES=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_PACKAGES,b.BOOKINGS=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a.AccountManagementSections=b;var c=function(){function a(){}return a}();c.clientPagesConst=new ClientPages,c.PERSONAL_INFO=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,c.PACKAGES=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_PACKAGES,c.BOOKINGS=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a.AccountManagementPages=c}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.INDIVIDUAL="INDIVIDUAL",b.GROUP="GROUP",a.OfferingTypes=b;var c=function(){function a(a,b,c){var d={allowedActions:{}};Object.assign(this,d,a),this.offeringDetails=c,this.staffMemberDetails=b}return a}();a.AccountBooking=c}(b=a.bookings||(a.bookings={}))}(b=a.account||(a.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.account.bookings.AccountBooking,d=a.bookings.account.bookings.OfferingTypes,e=function(){function a(a,b){this.accountManagementApiSrv=a,this.appointmentService=b}return a.$inject=["accountManagementApiSrv","appointmentService"],a.prototype.buildBookingList=function(a){var b=this,c=this.createMapById(a.relatedStaff),d=this.createMapById(a.relatedOfferings);return{bookings:a.bookings.map(function(a){return b.buildBooking(a,c[a.staffId],d[a.offeringId])})}},a.prototype.buildBooking=function(a,b,d){return new c(a,b,d)},a.prototype.cancelingBooking=function(a,b){this.accountManagementApiSrv.cancelingBooking(a.bookings[b]).then(function(){a.bookings=a.bookings.filter(function(a,c){return b!==c})})},a.prototype.gettingBookings=function(){var a=this;return this.accountManagementApiSrv.gettingBookings().then(function(b){return a.buildBookingList(b)})},a.prototype.reschedulingBooking=function(){var a=this.appointmentService.getCurrentBooking(),b=this.appointmentService.getSelectedTime(),c={staffMemberId:a.staffMemberDetails.id,bookingId:a.bookingId,offeringType:a.offeringDetails.type};return Object.assign(c,c.offeringType===d.INDIVIDUAL?{start:b.startTime,end:b.endTime}:{groupInstanceId:b.groupInstance.id,originalGroupInstanceId:a.groupInstanceId}),this.accountManagementApiSrv.rescheduleBooking(c)},a.prototype.createMapById=function(a){return a.reduce(function(a,b){return a[b.id]=b,a},{})},a}();b.BookingHistorySrv=e,angular.module("schedulerAngularClientAppInternal").service("bookingHistorySrv",e)}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.account.bookings.OfferingTypes,d=function(){function a(){}return a}();d.API_PREFIX="_api/scheduler-server/site-member/",d.UPDATE_CONTACT="contact",d.CANCEL_BOOKING="booking",d.GET_BOOKINGS="bookings",d.RESCHEDULE_BOOKING="booking",b.AccountManagementApiConst=d;var e=function(){function a(b,c){var e=this;this.$http=b,this.commonApiBase=c,this.updatingContact=this.commonApiBase.httpWrapper(function(a){return e.$http.put(""+d.API_PREFIX+d.UPDATE_CONTACT,a)}),this.cancelingBooking=this.commonApiBase.httpWrapper(function(b){return e.$http["delete"](""+d.API_PREFIX+d.CANCEL_BOOKING+"/"+b.offeringDetails.type+"/"+b.bookingId+a.getBookingUrlSuffix(b))}),this.gettingBookings=this.commonApiBase.httpWrapper(function(){return e.$http.get(""+d.API_PREFIX+d.GET_BOOKINGS)}),this.rescheduleBooking=this.commonApiBase.httpWrapper(function(b){return e.$http.put(""+d.API_PREFIX+d.RESCHEDULE_BOOKING+"/"+b.offeringType+"/"+b.bookingId+a.getRescheduleBookingUrlSuffix(b),b)})}return a.$inject=["$http","commonApiBase"],a.getBookingUrlSuffix=function(a){return a.offeringDetails.type===c.GROUP?"/"+a.groupInstanceId:""},a.getRescheduleBookingUrlSuffix=function(a){return a.offeringType===c.GROUP?"/"+a.originalGroupInstanceId:""},a}();b.AccountManagementApiSrv=e,angular.module("schedulerAngularClientAppInternal").service("accountManagementApiSrv",e)}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){var b={};Object.assign(this,b,a)}return a}(),c=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$wix=a,this.boostInjectionPersister=b,this.accountManagementApiSrv=c,this.routeManager=d,this.cacheSrv=e,this.clientPages=f,this.visitorBILogger=g,this.$timeout=h,this.$rootScope=i,this.experimentsEnabler=j,this.$translate=k,this.wixSdkUtil=l,this.isInApp="site"===this.$wix.Utils.getViewMode(),this.initCurrentMemberStatus()}return a.$inject=["$wix","boostInjectionPersister","accountManagementApiSrv","routeManager","cacheSrv","clientPages","visitorBILogger","$timeout","$rootScope","experimentsEnabler","$translate","wixSdkUtil"],a.prototype.isLoggedIn=function(){return this.isInApp&&this.isCurrentUserPresent},a.prototype.logoutUser=function(){this.isInApp&&(this.$rootScope.$emit(a.LOGOUT_INITIATED),this.$wix.logOutCurrentMember())},a.prototype.loginUser=function(){var b=this;this.isInApp&&this.$wix.requestLogin({mode:"login",language:this.$translate.preferredLanguage()},function(){b.visitorBILogger.logLoginComplete({success:!0});var c=b.routeManager.getFullPageDefinition();b.cacheSrv.setToCache(a.POST_LOGIN_PATH_KEY,c)})},a.prototype.getCurrentSiteMember=function(){return this.currentSiteMember},a.prototype.buildSiteMember=function(a){return new b(a)},a.prototype.updatingSiteMember=function(a){var b=this;return this.accountManagementApiSrv.updatingContact(a).then(function(){b.currentSiteMember=b.buildSiteMember(a)})},a.prototype.restoreLoginState=function(){var b=this.getPreviousPageInfo();b&&(this.cacheSrv.clearKey(a.POST_LOGIN_PATH_KEY),this.routeManager.gotoFullPage(b))},a.prototype.getPreviousPageInfo=function(){return this.cacheSrv.getFromCache(a.POST_LOGIN_PATH_KEY)},a.prototype.isPathAllowed=function(a){return this.isLoggedIn()||!this.isPathProtected(a)},a.prototype.isUserLoginAllowed=function(){return this.experimentsEnabler.isSiteMembersLoginEnabled()&&"false"!==this.wixSdkUtil.getTextForModel("showMemberLogin_Checkbox","")},a.prototype.isInitialized=function(){return this.initialized},a.prototype.isPathProtected=function(a){return a&&a.indexOf(this.clientPages.USER_ACCOUNT_MANAGEMENT)>-1},a.prototype.initCurrentMemberStatus=function(){var a=this;this.initialized=!1,this.isCurrentUserPresent=!1,this.currentSiteMember={},this.isInApp&&this.isUserLoginAllowed()?this.$wix.currentMember(function(b){a.$timeout(function(){return a.onCurrentMemberRetrieved(b)})}):this.initialized=!0},a.prototype.onCurrentMemberRetrieved=function(a){this.initialized=!0,this.isCurrentUserPresent=!!a,this.isCurrentUserPresent&&(this.currentSiteMember=this.boostInjectionPersister.getCurrentMember()||{})},a}();c.POST_LOGIN_PATH_KEY="UserManagementSrv.post-login-path-key",c.LOGOUT_INITIATED="UserManagementSrv.logout-initiated",a.UserManagementSrv=c,angular.module("schedulerAngularClientAppInternal").service("userManagementSrv",c)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f){this.userManagementSrv=a,this.experimentsEnabler=b,this.routeManager=c,this.clientPages=d,this.visitorBILogger=e,this.wixSdkUtil=f}return Object.defineProperty(a.prototype,"isUserLoggedIn",{get:function(){return this.userManagementSrv.isLoggedIn()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"userLoginAllowed",{get:function(){return this.userManagementSrv.isInitialized()&&this.userManagementSrv.isUserLoginAllowed()},enumerable:!0,configurable:!0}),a.prototype.login=function(){this.visitorBILogger.logLoginClicked(),this.userManagementSrv.loginUser()},a.prototype.logout=function(){this.userManagementSrv.logoutUser()},a.prototype.goToUserManagement=function(){this.visitorBILogger.logGoToAccountManagement(),this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT)},Object.defineProperty(a.prototype,"userName",{get:function(){var a=this.userManagementSrv.getCurrentSiteMember().fullName;return a?a.split(" ")[0]:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"userImage",{get:function(){return this.userManagementSrv.getCurrentSiteMember().imageUrl},enumerable:!0,configurable:!0}),a}();a.BaseUserLoginComponent=b}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){return a.call(this,b,c,d,e,f,g)||this}return __extends(b,a),b.$inject=["userManagementSrv","experimentsEnabler","routeManager","clientPages","visitorBILogger","wixSdkUtil"],b}(a.BaseUserLoginComponent);a.UserLoginComponent=b,angular.module("schedulerAngularClientAppInternal").component("bksUserLogin",{templateUrl:"modules/desktop/user-management/user-login/user-login.preload.html",controller:b})}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.routeManager=a,this.clientPages=b,this.experimentsEnabler=c}return b.prototype.$onInit=function(){this.sections=[{key:"account-management.section.bookings",code:a.AccountManagementSections.BOOKINGS},{key:"account-management.section.personal-info",code:a.AccountManagementSections.PERSONAL_INFO}],this.experimentsEnabler.isPackagesEnabled()&&this.sections.splice(1,0,{key:"account-management.section.packages",code:a.AccountManagementSections.PACKAGES})},b.prototype.gotoServices=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},b.prototype.gotoSection=function(a){this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT+"/"+a.code)},b.prototype.isSectionSelected=function(a){return a.code===this.sectionKey},b}();a.BaseAccountManagementHeaderController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}return __extends(b,a),b.$inject=["routeManager","clientPages","experimentsEnabler"],b}(a.BaseAccountManagementHeaderController);a.AccountManagementHeaderController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementHeader",{templateUrl:"modules/desktop/account-management/account-management-header/account-management-header.preload.html",controller:b,bindings:{sectionKey:"@section"}})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a){this.userManagementSrv=a,this.initSiteMember()}return Object.defineProperty(b.prototype,"section",{get:function(){return a.AccountManagementSections.PERSONAL_INFO},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currentSiteMember",{get:function(){return this.siteMember},enumerable:!0,configurable:!0}),b.prototype.onCancelMemberUpdate=function(){this.showSuccessMessage=!1,this.initSiteMember()},b.prototype.onSiteMemberSaved=function(a){var b=this;this.showSuccessMessage=!1,this.userManagementSrv.updatingSiteMember(a).then(function(){b.showSuccessMessage=!0})},b.prototype.initSiteMember=function(){this.siteMember=this.userManagementSrv.buildSiteMember(this.userManagementSrv.getCurrentSiteMember())},b}();a.BaseAccountManagementUserInfoController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.save=function(a){this.submittedInvalid=a.$invalid,a.$valid&&this.onSave({siteMember:this.siteMember})},a.prototype.cancel=function(){this.onCancel({siteMember:this.siteMember})},a}();b.bindings={siteMember:"<",onCancel:"&",onSave:"&"},a.BaseAccountManagementUserInfoFormController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b){this.bookingHistorySrv=a,this.flowManagerSrv=b}return b.prototype.cancelBooking=function(a,b){this.bookingHistorySrv.cancelingBooking(this.bookingList,b)},b.prototype.rescheduleBooking=function(a){var b=this;this.flowManagerSrv.initiateReschedule(a,this.timezone).then(function(){b.flowManagerSrv.next()})},b.prototype.bookAnotherBooking=function(a){var b=this;this.flowManagerSrv.initiateBookAnother(a).then(function(){b.flowManagerSrv.next()})},Object.defineProperty(b.prototype,"section",{get:function(){return a.AccountManagementSections.BOOKINGS},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"hasBookings",{get:function(){return!!this.bookingList.bookings.length},enumerable:!0,configurable:!0}),b}();b.bindings={bookingList:"=",timezone:"@"},a.BaseAccountManagementBookingsController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.$translate=a,this.libs=b,this.$scope=c,this.isExpanded=!1,this.cancelConfirm=!1,this.timeFormat=this.$translate("account-management.bookings.time-format")}return Object.defineProperty(a.prototype,"title",{get:function(){return this.booking.offeringDetails.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"date",{get:function(){return this.libs.moment.tz(this.booking.start,this.timezone).format(this.timeFormat);
},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"staffDetails",{get:function(){return this.$translate("account-management.bookings.staff-format",this.booking.staffMemberDetails)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"location",{get:function(){return this.booking.location},enumerable:!0,configurable:!0}),a.prototype.isRescheduleAllowed=function(){return this.booking.allowedActions.reschedule},a.prototype.isCancelAllowed=function(){return this.booking.allowedActions.cancel},a.prototype.isBookAnotherAllowed=function(){return this.booking.allowedActions.bookAnother},a.prototype.onCancelClicked=function(){this.cancelConfirm=!0},a.prototype.onCancelRevert=function(){this.cancelConfirm=!1},a.prototype.onCancelConfirmed=function(){this.cancelConfirm=!1,this.onCancel({booking:this.booking})},a.prototype.onRescheduleClicked=function(){this.onReschedule({booking:this.booking})},a.prototype.onBookAnotherClicked=function(){this.onBookAnother({booking:this.booking})},a.prototype.applyChanges=function(){return this.$scope.$apply()},a}();b.bindings={booking:"<",onCancel:"&",onReschedule:"&",onBookAnother:"&",timezone:"@"},a.BaseAccountManagementBookingItemController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.reschedule=function(a,b){this.onReschedule({booking:a,index:b})},a.prototype.cancel=function(a,b){this.onCancel({booking:a,index:b})},a.prototype.bookAnother=function(a,b){this.onBookAnother({booking:a,index:b})},a}();b.bindings={bookings:"<",onReschedule:"&",onBookAnother:"&",onCancel:"&",timezone:"@"},a.BaseAccountManagementBookingsListController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b){return a.call(this,b)||this}return __extends(b,a),b.$inject=["userManagementSrv"],b}(a.BaseAccountManagementUserInfoController);a.AccountManagementUserInfoController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfo",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info.preload.html",controller:b})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementUserInfoFormController);a.AccountManagementUserInfoFormController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfoForm",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info-form/account-management-user-info-form.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementUserInfoFormController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c){return a.call(this,b,c)||this}return __extends(b,a),b.$inject=["bookingHistorySrv","flowManagerSrv"],b}(a.BaseAccountManagementBookingsController);a.AccountManagementBookingsController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookings",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementBookingsListController);a.AccountManagementBookingsListController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingsList",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings-list/account-management-bookings-list.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsListController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}return __extends(b,a),b.$inject=["$translate","libs","$scope"],b}(a.BaseAccountManagementBookingItemController);a.AccountManagementBookingItemController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingItem",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-booking-item/account-management-booking-item.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingItemController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var LoggedInContactInfo=function(){function a(){}return a}();angular.module("schedulerAngularClientAppInternal").component("bksLoggedInContactInfo",{controller:LoggedInContactInfo,templateUrl:"modules/logged-in-contact-info/logged-in-contact-info.preload.html",bindings:{contactInfo:"="}});var NextStepLabelComponent=function(){function a(a,b,c){this.paymentService=a,this.experimentsEnabler=b,this.$location=c,this.isLastStep?this.defineLabelForLastStep():this.defineDefaultLabel(),this.enhanceSettingsKey()}return a.$inject=["paymentService","experimentsEnabler","$location"],a.prototype.defineDefaultLabel=function(){this.key="calendar.next",this.settingsKey="textNextStepLabel"},a.prototype.defineLabelForLastStep=function(){this.isOnlyOneOnlinePaymentOption()?(this.key="visitor.confirmation.wizard.next-paypal",this.settingsKey="textPayNowLabel"):(this.key="visitor.confirmation.wizard.next",this.settingsKey="textBookNowLabel")},a.prototype.enhanceSettingsKey=function(){this.settingsKey+=this.isGroupsFlow()?a.GROUPS_SUFFIX:"",this.experimentsEnabler.isSettingMultiBookItLabelsEnabled()||(this.settingsKey="")},a.prototype.isOnlyOneOnlinePaymentOption=function(){return this.paymentService.isPaymentNeeded()&&(this.paymentService.isPaypalOnly()||this.paymentService.isStripeOnly())},a.prototype.isGroupsFlow=function(){return this.$location.path().indexOf("/groups/")>-1},a}();NextStepLabelComponent.GROUPS_SUFFIX="Groups",angular.module("schedulerAngularClientAppInternal").component("boostNextStepLabel",{template:'<span data-hook="next-step-label">{{ $ctrl.key | wixSdkTranslate: $ctrl.settingsKey}}</span>',controller:NextStepLabelComponent,bindings:{isLastStep:"="}}),angular.module("schedulerAngularClientAppInternal").directive("bksOnTransitionEnd",function(){return{restrict:"A",scope:{bksOnTransitionEnd:"&"},link:function(a,b){return b.on("transitionend",function(){return a.bksOnTransitionEnd()})}}});var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.user.account.AccountManagementPages,d=a.bookings.account.bookings.OfferingTypes,e=function(){function a(a,b){this.routeManager=a,this.clientPages=b}return a.prototype.prev=function(){this.navigateToDefaultStep()},a.prototype.next=function(){this.navigateToDefaultStep()},a.prototype.navigateToDefaultStep=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a}(),f=function(){function a(a,b){this.clientPages=a,this.routeManager=b,this.flowSteps={}}return a.prototype.addStep=function(a,b){this.flowSteps[a]=b},a.prototype.next=function(a){this.getFlowStep(a).next()},a.prototype.prev=function(a){this.getFlowStep(a).prev()},a.prototype.isNavigationAllowed=function(a,b){var c=this.getFlowStep(a);return!(!c||!c[b])},a.prototype.getFlowStep=function(a){var b=Object.keys(this.flowSteps).find(function(b){return a.startsWith(b)});return this.flowSteps[b]},a}(),g=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,c)||this;return h.appointmentService=d,h.booking=e,h.timezone=f,h.bookingHistorySrv=g,h.addSteps(),h.init(),h}return __extends(b,a),b.prototype.addSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONGRATS)})},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b.prototype.init=function(){this.appointmentService.initiate(this.booking.offeringDetails),this.appointmentService.setCurrentBooking(this.booking)},b}(f),h=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,c)||this;return h.appointmentService=d,h.booking=e,h.timezone=f,h.bookingHistorySrv=g,h.addSteps(),h.init(),h}return __extends(b,a),b.prototype.addSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.GROUPS_VISITOR_CONGRATS)})},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b.prototype.init=function(){this.appointmentService.initiate(this.booking.offeringDetails),this.appointmentService.setCurrentBooking(this.booking)},b}(f),i=function(a){function b(b,c,d,e,f){var g=a.call(this,b,c)||this;return g.appointmentService=d,g.selectedOffering=e,g.ServiceTypes=f,g.addSteps(),g.init(),g}return __extends(b,a),b.prototype.init=function(){this.initiateOffering(),this.appointmentService.initiate(this.selectedOffering)},b.prototype.initiateOffering=function(){this.selectedOffering.type=this.ServiceTypes.INDIVIDUAL},b.prototype.addSteps=function(){this.addIndividualSteps()},b.prototype.addIndividualSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)}})},b}(f),j=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b.prototype.initiateOffering=function(){this.selectedOffering.type=this.ServiceTypes.GROUP},b.prototype.addSteps=function(){this.addGroupFlowSteps()},b.prototype.addGroupFlowSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS)}})},b}(i),k=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addGroupFlowSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(j),l=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addIndividualSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(i),m=function(a){function b(b,c){return a.call(this,b,c,null,null,null)||this}return __extends(b,a),b.prototype.init=function(){},b.prototype.addSteps=function(){this.addIndividualSteps(),this.addGroupFlowSteps()},b}(j),n=function(){function a(a,b,c,d,e,f,g,h,i,j){this.routeManager=a,this.appointmentService=b,this.cacheSrv=c,this.clientPages=d,this.ServiceTypes=e,this.servicesSrv=f,this.groupsSrv=g,this.$q=i,this.bookingHistorySrv=j,h.isOverEditor&&(this.fallbackFlow=new m(this.clientPages,this.routeManager)),this.restoreFlowData()}return a.$inject=["routeManager","appointmentService","cacheSrv","clientPages","ServiceTypes","servicesSrv","groupsSrv","overEditor","$q","bookingHistorySrv"],a.prototype.initiateIndividual=function(a){return this.storeFlowData("initiateIndividual",arguments),this.currentFlow=new i(this.clientPages,this.routeManager,this.appointmentService,a,this.ServiceTypes),this.$q.when()},a.prototype.initiateGroup=function(a){return this.storeFlowData("initiateGroup",arguments),this.currentFlow=new j(this.clientPages,this.routeManager,this.appointmentService,a,this.ServiceTypes),this.$q.when()},a.prototype.initiateReschedule=function(a,b){this.storeFlowData("initiateReschedule",arguments);var c=a.offeringDetails.type===d.GROUP?this.rescheduleGroup:this.rescheduleIndividual;return c.apply(this,arguments)},a.prototype.initiateBookAnother=function(a){this.storeFlowData("initiateBookAnother",arguments);var b=a.offeringDetails.type===d.GROUP?this.bookAnotherGroup:this.bookAnotherIndividual;return b.apply(this,arguments)},a.prototype.rescheduleIndividual=function(a,b){return this.currentFlow=new g(this.clientPages,this.routeManager,this.appointmentService,a,b,this.bookingHistorySrv),this.$q.when()},a.prototype.rescheduleGroup=function(a,b){return this.currentFlow=new h(this.clientPages,this.routeManager,this.appointmentService,a,b,this.bookingHistorySrv),this.$q.when()},a.prototype.bookAnotherGroup=function(a){var b=this;return this.groupsSrv.gettingGroupsList().then(function(c){b.bookAnotherOfferingBase(c.classes,a,k)})},a.prototype.bookAnotherIndividual=function(a){var b=this;return this.servicesSrv.gettingServices().then(function(c){b.bookAnotherOfferingBase(c.services,a,l)})},a.prototype.bookAnotherOfferingBase=function(a,b,c){var d=b.offeringDetails.id,e=a.find(function(a){return d===a.id});e&&(this.currentFlow=new c(this.clientPages,this.routeManager,this.appointmentService,e,this.ServiceTypes))},a.prototype.next=function(){this.doNavigation("next")},a.prototype.prev=function(){this.doNavigation("prev")},a.prototype.doNavigation=function(a){var b=this.routeManager.getCurrentPagePartialPath();this.isNavigationPossible(b,a)?this.currentFlow[a](b):this.doFallbackNavigation(b,a)},a.prototype.doFallbackNavigation=function(a,b){this.fallbackFlowNavigationPossible(a,b)?this.fallbackFlow[b](a):new e(this.routeManager,this.clientPages)[b]()},a.prototype.isNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.currentFlow,a,b)},a.prototype.fallbackFlowNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.fallbackFlow,a,b)},a.prototype.isNavigationPossibleForFlow=function(a,b,c){return a&&a.isNavigationAllowed(b,c)},a.prototype.storeFlowData=function(b,c){this.cacheSrv.setToCache(a.CACHE_KEY,{flowInitMethod:b,args:Array.prototype.slice.call(c)})},a.prototype.restoreFlowData=function(){var b=this.cacheSrv.getFromCache(a.CACHE_KEY);b&&b.flowInitMethod&&this[b.flowInitMethod].apply(this,b.args)},a}();n.CACHE_KEY="flowManagerData",b.FlowManagerSrv=n,angular.module("schedulerAngularClientAppInternal").service("flowManagerSrv",n)}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));